<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analysis Pipeline · BayesInteractomics.jl</title><meta name="title" content="Analysis Pipeline · BayesInteractomics.jl"/><meta property="og:title" content="Analysis Pipeline · BayesInteractomics.jl"/><meta property="twitter:title" content="Analysis Pipeline · BayesInteractomics.jl"/><meta name="description" content="Documentation for BayesInteractomics.jl."/><meta property="og:description" content="Documentation for BayesInteractomics.jl."/><meta property="twitter:description" content="Documentation for BayesInteractomics.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/analysis/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/analysis/"/><link rel="canonical" href="https://ma-seefelder.github.io/BayesInteractomics.jl/analysis/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesInteractomics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../data_loading/">Data Loading</a></li><li><a class="tocitem" href="../data_curation/">Data Curation</a></li><li class="is-active"><a class="tocitem" href>Analysis Pipeline</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Pipeline-Architecture"><span>Pipeline Architecture</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Caching"><span>Caching</span></a></li><li><a class="tocitem" href="#Parallel-Processing"><span>Parallel Processing</span></a></li><li><a class="tocitem" href="#Multiple-Imputation"><span>Multiple Imputation</span></a></li><li><a class="tocitem" href="#Evidence-Combination-Methods"><span>Evidence Combination Methods</span></a></li><li><a class="tocitem" href="#Output-Structure"><span>Output Structure</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../model_fitting/">Model Fitting</a></li><li><a class="tocitem" href="../model_evaluation/">Model Evaluation</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../differential_analysis/">Differential Analysis</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../reports/">Reports</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../mathematical_background/">Mathematical Background</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Analysis Pipeline</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analysis Pipeline</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/main/docs/src/analysis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Analysis-Pipeline"><a class="docs-heading-anchor" href="#Analysis-Pipeline">Analysis Pipeline</a><a id="Analysis-Pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-Pipeline" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The analysis module orchestrates the complete workflow for identifying protein-protein interactions. It coordinates data loading, statistical modeling, evidence combination, and result generation into a seamless pipeline.</p><p>BayesInteractomics provides two levels of entry points:</p><ul><li><strong><code>run_analysis(config)</code></strong>: High-level function that handles everything from data loading to final results, with intelligent caching</li><li><strong><code>analyse(data, ...)</code></strong>: Lower-level function that runs the core Bayesian pipeline on pre-loaded data</li></ul><h2 id="Pipeline-Architecture"><a class="docs-heading-anchor" href="#Pipeline-Architecture">Pipeline Architecture</a><a id="Pipeline-Architecture-1"></a><a class="docs-heading-anchor-permalink" href="#Pipeline-Architecture" title="Permalink"></a></h2><h3 id="run_analysis-Workflow"><a class="docs-heading-anchor" href="#run_analysis-Workflow"><code>run_analysis</code> Workflow</a><a id="run_analysis-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#run_analysis-Workflow" title="Permalink"></a></h3><pre><code class="nohighlight hljs">CONFIG
  │
  ├─ load_data() ──── Data loading &amp; curation
  │
  ├─ Cache check ──── Skip if config+data unchanged
  │
  ├─ analyse() ────── Core Bayesian pipeline
  │   ├── Step 1: Beta-Bernoulli (detection BFs)
  │   ├── Step 2: HBM + Regression (enrichment &amp; correlation BFs)
  │   └── Step 3: Evidence combination (copula-EM or latent class)
  │
  ├─ Model comparison ── WAIC (Normal vs. robust regression)
  │
  ├─ Diagnostics ──── PPC, residuals, calibration (optional)
  │
  ├─ Sensitivity ──── Prior sensitivity analysis (optional)
  │
  ├─ Visualization ── Volcano, convergence, evidence plots
  │
  └─ Report ────────── Interactive HTML report (optional)</code></pre><h3 id="Core-Pipeline-(analyse)"><a class="docs-heading-anchor" href="#Core-Pipeline-(analyse)">Core Pipeline (<code>analyse</code>)</a><a id="Core-Pipeline-(analyse)-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Pipeline-(analyse)" title="Permalink"></a></h3><p>The <code>analyse()</code> function implements a multi-stage Bayesian workflow:</p><h4 id="Step-1:-H0-Computation"><a class="docs-heading-anchor" href="#Step-1:-H0-Computation">Step 1: H0 Computation</a><a id="Step-1:-H0-Computation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-H0-Computation" title="Permalink"></a></h4><ul><li>Computes or loads null hypothesis Bayes factors from permuted data</li><li>Stores null distribution in <code>copula_H0.xlsx</code></li><li>Required for copula-based evidence combination</li></ul><h4 id="Step-2:-Beta-Bernoulli-Detection-Model"><a class="docs-heading-anchor" href="#Step-2:-Beta-Bernoulli-Detection-Model">Step 2: Beta-Bernoulli Detection Model</a><a id="Step-2:-Beta-Bernoulli-Detection-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Beta-Bernoulli-Detection-Model" title="Permalink"></a></h4><p>Parallelized across all proteins:</p><ul><li>Estimates detection probabilities using a Beta-Bernoulli model</li><li>Generates Bayes factors for detection evidence</li><li>Thread-safe computation with progress bar</li></ul><h4 id="Step-3:-Hierarchical-Bayesian-Model-Regression"><a class="docs-heading-anchor" href="#Step-3:-Hierarchical-Bayesian-Model-Regression">Step 3: Hierarchical Bayesian Model + Regression</a><a id="Step-3:-Hierarchical-Bayesian-Model-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Hierarchical-Bayesian-Model-Regression" title="Permalink"></a></h4><p>Parallelized analysis of enrichment and correlation:</p><ul><li><strong>Enrichment (HBM)</strong>: Log₂ fold-change across conditions using variational Bayes</li><li><strong>Correlation (Regression)</strong>: Dose-response relationships via Bayesian linear regression</li><li>Supports both Normal and robust (Student-t) regression likelihoods</li><li>Results cached in thread-specific files under <code>cache/</code></li></ul><h4 id="Step-4:-Evidence-Combination"><a class="docs-heading-anchor" href="#Step-4:-Evidence-Combination">Step 4: Evidence Combination</a><a id="Step-4:-Evidence-Combination-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Evidence-Combination" title="Permalink"></a></h4><p>Two methods available:</p><ul><li><strong>Copula-EM</strong> (<code>:copula</code>, default): Fits mixture of copulas with EM algorithm</li><li><strong>Latent Class</strong> (<code>:latent_class</code>): Variational message passing approach</li></ul><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><p>All analysis parameters are centralized in the <a href="#BayesInteractomics.CONFIG"><code>CONFIG</code></a> struct:</p><pre><code class="language-julia hljs">config = CONFIG(
    # Required: data and column specifications
    datafile = [&quot;experiment.xlsx&quot;],
    sample_cols = [Dict(1 =&gt; [5,6,7])],
    control_cols = [Dict(1 =&gt; [2,3,4])],
    poi = &quot;BAIT_PROTEIN&quot;,

    # Output paths (auto-generated from basedir)
    output = OutputFiles(&quot;/path/to/results&quot;),
    # or: output = OutputFiles(&quot;/path/to/results&quot;, image_ext=&quot;.svg&quot;)

    # Analysis parameters
    n_controls = 3,
    n_samples = 3,
    refID = 1,
    normalise_protocols = true,

    # Evidence combination
    combination_method = :copula,        # or :latent_class
    em_prior = :default,                 # or :APMS, :BioID, :TurboID, :stringent, :permissive
    em_n_restarts = 20,
    copula_criterion = :BIC,

    # Regression model
    regression_likelihood = :robust_t,   # or :normal
    student_t_nu = 5.0,
    run_model_comparison = true,
    optimize_nu = true,

    # Diagnostics (optional)
    run_diagnostics = false,
    run_sensitivity = true,

    # Data curation
    curate = true,
    species = 9606,
    bait_name = &quot;BAIT_PROTEIN&quot;,

    # Report
    generate_report_html = true
)</code></pre><h3 id="Output-Files"><a class="docs-heading-anchor" href="#Output-Files">Output Files</a><a id="Output-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Output-Files" title="Permalink"></a></h3><p>All output paths are managed through the <a href="#BayesInteractomics.OutputFiles"><code>OutputFiles</code></a> struct:</p><pre><code class="language-julia hljs">output = OutputFiles(&quot;/path/to/results&quot;)
# Auto-generates:
#   copula_H0.xlsx, final_results.xlsx, volcano_plot.png,
#   convergence.png, evidence.png, em_diagnostics.png,
#   interactive_report.html, methods.md, ...

# Override individual paths:
output.results_file = &quot;custom_name.xlsx&quot;

# Use SVG instead of PNG:
output = OutputFiles(&quot;/path/to/results&quot;, image_ext = &quot;.svg&quot;)</code></pre><h2 id="Caching"><a class="docs-heading-anchor" href="#Caching">Caching</a><a id="Caching-1"></a><a class="docs-heading-anchor-permalink" href="#Caching" title="Permalink"></a></h2><h3 id="Result-Level-Caching"><a class="docs-heading-anchor" href="#Result-Level-Caching">Result-Level Caching</a><a id="Result-Level-Caching-1"></a><a class="docs-heading-anchor-permalink" href="#Result-Level-Caching" title="Permalink"></a></h3><p><code>run_analysis</code> uses hash-based caching to skip redundant computation:</p><pre><code class="language-julia hljs"># First run: performs full analysis and caches
final_df, result = run_analysis(config)

# Second run with same config/data: loads from cache
final_df, result = run_analysis(config)

# Force re-computation
final_df, result = run_analysis(config, use_cache = false)</code></pre><p>Cache files are stored in <code>.bayesinteractomics_cache/</code> next to the first data file.</p><h3 id="Intermediate-Caching"><a class="docs-heading-anchor" href="#Intermediate-Caching">Intermediate Caching</a><a id="Intermediate-Caching-1"></a><a class="docs-heading-anchor-permalink" href="#Intermediate-Caching" title="Permalink"></a></h3><p>Individual pipeline steps can be cached separately:</p><pre><code class="language-julia hljs">results = analyse(data, &quot;copula_H0.xlsx&quot;,
    use_intermediate_cache = true,
    betabernoulli_cache_file = &quot;bb_cache.jld2&quot;,
    hbm_regression_cache_file = &quot;hbm_cache.jld2&quot;
)</code></pre><p>This is useful when iterating on copula-EM parameters without re-running inference.</p><h2 id="Parallel-Processing"><a class="docs-heading-anchor" href="#Parallel-Processing">Parallel Processing</a><a id="Parallel-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-Processing" title="Permalink"></a></h2><p>The package uses Julia&#39;s multi-threading:</p><pre><code class="language-bash hljs"># Launch Julia with multiple threads
julia --threads=auto</code></pre><ul><li><strong>Thread Safety</strong>: Each thread writes to separate cache files</li><li><strong>Load Balancing</strong>: Proteins distributed evenly across threads</li><li><strong>Error Handling</strong>: Failures logged per-protein to <code>log.txt</code> without blocking others</li></ul><h2 id="Multiple-Imputation"><a class="docs-heading-anchor" href="#Multiple-Imputation">Multiple Imputation</a><a id="Multiple-Imputation-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Imputation" title="Permalink"></a></h2><p>For handling missing data with multiple imputation:</p><pre><code class="language-julia hljs"># Pass vector of imputed datasets + raw data
results = analyse(
    imputed_data_vector,  # Vector{InteractionData}
    raw_data,             # InteractionData (for Beta-Bernoulli)
    &quot;copula_H0.xlsx&quot;,
    n_controls = 3, n_samples = 3, refID = 1
)</code></pre><p>Results are automatically pooled:</p><ul><li>HBM and regression are run on each imputed dataset</li><li>Pooled using <code>evaluate_imputed_fc_posteriors()</code> (Rubin&#39;s rules)</li><li>Beta-Bernoulli uses raw (non-imputed) data</li></ul><h2 id="Evidence-Combination-Methods"><a class="docs-heading-anchor" href="#Evidence-Combination-Methods">Evidence Combination Methods</a><a id="Evidence-Combination-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Evidence-Combination-Methods" title="Permalink"></a></h2><h3 id="Copula-EM-(default)"><a class="docs-heading-anchor" href="#Copula-EM-(default)">Copula-EM (default)</a><a id="Copula-EM-(default)-1"></a><a class="docs-heading-anchor-permalink" href="#Copula-EM-(default)" title="Permalink"></a></h3><pre><code class="language-julia hljs">combination_method = :copula</code></pre><ul><li>Fits mixture: <code>π₀ · Copula(H₀) + π₁ · Copula(H₁)</code></li><li>Automatic copula selection (Clayton, Frank, Gumbel, Gaussian, Joe)</li><li>Multiple restarts to avoid local optima</li><li>SQUAREM acceleration for faster convergence</li><li>Supports informative priors on π₁</li></ul><h3 id="Latent-Class"><a class="docs-heading-anchor" href="#Latent-Class">Latent Class</a><a id="Latent-Class-1"></a><a class="docs-heading-anchor-permalink" href="#Latent-Class" title="Permalink"></a></h3><pre><code class="language-julia hljs">combination_method = :latent_class</code></pre><ul><li>Variational message passing approach</li><li>Does not require pre-computed H0 file</li><li>Winsorization of extreme Bayes factors</li><li>Dirichlet prior on class proportions</li></ul><h2 id="Output-Structure"><a class="docs-heading-anchor" href="#Output-Structure">Output Structure</a><a id="Output-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Output-Structure" title="Permalink"></a></h2><p><code>run_analysis</code> returns <code>(final_df, analysis_result)</code>:</p><h3 id="final_df-(DataFrame)"><a class="docs-heading-anchor" href="#final_df-(DataFrame)"><code>final_df</code> (DataFrame)</a><a id="final_df-(DataFrame)-1"></a><a class="docs-heading-anchor-permalink" href="#final_df-(DataFrame)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Column</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>Protein</code></td><td style="text-align: right">Protein identifier</td></tr><tr><td style="text-align: right"><code>BF</code></td><td style="text-align: right">Combined Bayes factor</td></tr><tr><td style="text-align: right"><code>posterior_prob</code></td><td style="text-align: right">Posterior probability of interaction</td></tr><tr><td style="text-align: right"><code>q</code></td><td style="text-align: right">Bayesian FDR q-value</td></tr><tr><td style="text-align: right"><code>mean_log2FC</code></td><td style="text-align: right">Mean log₂ fold change</td></tr><tr><td style="text-align: right"><code>bf_enrichment</code></td><td style="text-align: right">HBM Bayes factor</td></tr><tr><td style="text-align: right"><code>bf_correlation</code></td><td style="text-align: right">Regression Bayes factor</td></tr><tr><td style="text-align: right"><code>bf_detected</code></td><td style="text-align: right">Beta-Bernoulli Bayes factor</td></tr><tr><td style="text-align: right"><code>diagnostic_flag</code></td><td style="text-align: right">Quality flags (when diagnostics enabled)</td></tr><tr><td style="text-align: right"><code>sensitivity_range</code></td><td style="text-align: right">Prior sensitivity range (when enabled)</td></tr></table><h3 id="analysis_result-(AnalysisResult)"><a class="docs-heading-anchor" href="#analysis_result-(AnalysisResult)"><code>analysis_result</code> (AnalysisResult)</a><a id="analysis_result-(AnalysisResult)-1"></a><a class="docs-heading-anchor-permalink" href="#analysis_result-(AnalysisResult)" title="Permalink"></a></h3><p>Contains all analysis outputs including copula results, EM model, joint distributions, and caching metadata. Use accessor functions:</p><pre><code class="language-julia hljs">getProteins(result)              # Protein names
getBayesFactors(result)          # Combined BFs
getPosteriorProbabilities(result) # Posterior probabilities
getQValues(result)               # q-values
getMeanLog2FC(result)            # Mean log₂FC</code></pre><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="BayesInteractomics.run_analysis"><a class="docstring-binding" href="#BayesInteractomics.run_analysis"><code>BayesInteractomics.run_analysis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">run_analysis(config::CONFIG; use_cache=true, cache_file=&quot;&quot;, temp_result_file=&quot;temp_results.xlsx&quot;)</code></pre><p>Runs the complete analysis pipeline from data loading to final result generation with intelligent caching.</p><p>This function serves as a high-level wrapper that orchestrates the entire analysis workflow. It includes hash-based caching to avoid redundant computation when config and data haven&#39;t changed. The meta-learner is always re-run even when using cached results.</p><p><strong>Arguments</strong></p><ul><li><code>config::CONFIG</code>: Configuration struct containing all analysis parameters</li></ul><p><strong>Keywords</strong></p><ul><li><code>use_cache::Bool=true</code>: Enable cache checking and saving</li><li><code>cache_file::String=&quot;&quot;</code>: Custom cache file path (empty = auto-generate based on config)</li><li><code>temp_result_file::String=&quot;temp_results.xlsx&quot;</code>: Temporary results file during analysis</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{DataFrame, AnalysisResult}</code>: A tuple containing:<ul><li><code>final_results::DataFrame</code>: Final DataFrame with posterior probabilities updated by meta-learner</li><li><code>analysis_result::AnalysisResult</code>: Complete analysis results with caching metadata</li></ul></li></ul><p><strong>Cache Behavior</strong></p><ul><li>On cache hit: Loads copula results, EM results, and distributions from cache</li><li>Meta-learner always runs (uses <code>config.poi</code> which may change between runs)</li><li>Plots are always regenerated</li><li>Cache location: <code>.bayesinteractomics_cache/</code> directory next to first data file</li></ul><p><strong>Side Effects</strong></p><ul><li>Creates cache file if <code>use_cache=true</code> and analysis runs</li><li>Creates final results Excel file at <code>config.output.results_file</code></li><li>Generates and saves plots (volcano, convergence, rank-rank, evidence)</li><li>Creates and deletes temporary &quot;cache&quot; directory for intermediate files</li><li>Creates &quot;log.txt&quot; file for logging errors during analysis</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">config = CONFIG(
    datafile=[&quot;data.xlsx&quot;],
    control_cols=[Dict(1=&gt;[1,2,3])],
    sample_cols=[Dict(1=&gt;[4,5,6])],
    poi=&quot;MyBaitProtein&quot;,
    n_controls=3,
    n_samples=3,
    refID=1
)

# First run - performs full analysis and caches results
final_df, result = run_analysis(config)

# Second run with same config/data - uses cache (fast!)
final_df, result = run_analysis(config)

# Disable caching
final_df, result = run_analysis(config, use_cache=false)

# Custom cache location
final_df, result = run_analysis(config, cache_file=&quot;my_cache.jld2&quot;)</code></pre><p>See also: <a href="../network_analysis/#AnalysisResult"><code>AnalysisResult</code></a>, <a href="#BayesInteractomics.check_cache"><code>check_cache</code></a>, <a href="#BayesInteractomics.analyse"><code>analyse</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L1304-L1366">source</a></section><section><div><pre><code class="language-julia hljs">run_analysis(config::CONFIG, imputed_data::Vector{InteractionData}, raw_data::InteractionData;
             use_cache=true, cache_file=&quot;&quot;)</code></pre><p>Runs analysis pipeline with multiple imputation and intelligent caching.</p><p>Similar to single-dataset version but uses multiple imputed datasets for HBM/regression and raw data for Beta-Bernoulli model. Cache validation uses combined hash of all datasets.</p><p><strong>Arguments</strong></p><ul><li><code>config::CONFIG</code>: Configuration struct</li><li><code>imputed_data::Vector{InteractionData}</code>: Vector of imputed datasets</li><li><code>raw_data::InteractionData</code>: Original non-imputed data</li></ul><p><strong>Keywords</strong></p><ul><li><code>use_cache::Bool=true</code>: Enable cache checking and saving</li><li><code>cache_file::String=&quot;&quot;</code>: Custom cache file path (empty = auto-generate)</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{DataFrame, AnalysisResult}</code>: Final results and cached analysis result</li></ul><p>See also: <a href="#BayesInteractomics.run_analysis"><code>run_analysis(::CONFIG)</code></a>, <a href="../network_analysis/#AnalysisResult"><code>AnalysisResult</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L1837-L1859">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.analyse"><a class="docstring-binding" href="#BayesInteractomics.analyse"><code>BayesInteractomics.analyse</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">analyse(data, H0_file=&quot;copula_H0.xlsx&quot;; kwargs...)</code></pre><p>Performs the main Bayesian analysis pipeline on the provided proteomics data.</p><p>This function integrates results from three different models:</p><ol><li>A Beta-Bernoulli model for detection probabilities.</li><li>A hierarchical Bayesian model for protein enrichment (log2 fold change).</li><li>A Bayesian linear regression model for dose-response correlation.</li></ol><p>The Bayes factors from these models are combined using a copula to calculate a final, joint Bayes factor and posterior probability for each protein. The analysis is parallelized across proteins.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: The input data, typically from <code>load_data</code>, containing protein quantification data.</li><li><code>H0_file::String</code>: Path to the H0 file containing precomputed Bayes factors for the null hypothesis. If the file does not exist, it will be computed.</li></ul><p><strong>Keywords</strong></p><p><strong>Basic Analysis Parameters</strong></p><ul><li><code>n_controls::Int=0</code>: Number of controls in the dataset.</li><li><code>n_samples::Int=0</code>: Number of samples in the dataset.</li><li><code>refID::Int=1</code>: The reference ID for the main analysis function, typically referring to a reference condition.</li><li><code>plotHBMdists::Bool=false</code>: If <code>true</code>, generates and saves plots of the hierarchical Bayesian model distributions.</li><li><code>plotlog2fc::Bool=false</code>: If <code>true</code>, generates and saves plots of the log2 fold changes.</li><li><code>plotregr::Bool=false</code>: If <code>true</code>, generates and saves plots of the regression model.</li><li><code>plotbayesrange::Bool=false</code>: If <code>true</code>, generates and saves plots of the Bayes factor ranges.</li><li><code>verbose::Bool=false</code>: If <code>true</code>, prints detailed progress and debugging information.</li></ul><p><strong>Caching Parameters</strong></p><ul><li><code>temp_result_file::String=&quot;temp_results.xlsx&quot;</code>: Path for temporary results file.</li><li><code>use_intermediate_cache::Bool=true</code>: If <code>true</code>, enables caching of intermediate results (Beta-Bernoulli and HBM+Regression).</li><li><code>betabernoulli_cache_file::String=&quot;&quot;</code>: Path to cache file for Beta-Bernoulli results. Empty string disables caching for this step.</li><li><code>hbm_regression_cache_file::String=&quot;&quot;</code>: Path to cache file for HBM and regression results. Empty string disables caching for this step.</li></ul><p><strong>Copula-EM Parameters</strong></p><ul><li><code>prior::Union{Symbol, NamedTuple}=:default</code>: Prior specification for the EM algorithm. Use <code>:default</code> for automatic prior or provide a NamedTuple with <code>(α=..., β=...)</code> for custom Beta prior parameters.</li><li><code>n_restarts::Int=20</code>: Number of random restarts for the EM algorithm to avoid local optima.</li><li><code>copula_criterion::Symbol=:BIC</code>: Model selection criterion for copula fitting. Options: <code>:BIC</code>, <code>:AIC</code>.</li><li><code>h1_refitting::Bool=true</code>: If <code>true</code>, refits the H1 (alternative hypothesis) distribution after EM convergence.</li><li><code>burn_in::Int=10</code>: Number of initial EM iterations to discard before convergence checking.</li></ul><p><strong>Diagnostics Parameters</strong></p><ul><li><code>run_em_diagnostics::Bool=true</code>: If <code>true</code> and <code>n_restarts &gt; 1</code>, runs diagnostic analysis of EM restart stability and convergence.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: A named tuple containing the analysis results with the following fields:<ul><li><code>copula_results::DataFrame</code>: DataFrame with combined Bayes factors, posterior probabilities, q-values, and other key metrics for each protein.</li><li><code>df_hierarchical::DataFrame</code>: DataFrame with detailed results from the hierarchical and regression models.</li><li><code>convergence_plt</code>: A plot diagnosing the convergence of the EM algorithm.</li><li><code>em</code>: The fitted Expectation-Maximization model object.</li><li><code>joint_H0</code>: The estimated joint distribution under the null hypothesis (H0).</li><li><code>joint_H1</code>: The estimated joint distribution under the alternative hypothesis (H1).</li><li><code>em_diagnostics</code>: Detailed diagnostics from EM restart analysis (if <code>run_em_diagnostics=true</code> and <code>n_restarts &gt; 1</code>).</li><li><code>em_diagnostics_summary</code>: Summary statistics of EM diagnostics (if <code>run_em_diagnostics=true</code> and <code>n_restarts &gt; 1</code>).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L43-L98">source</a></section><section><div><pre><code class="language-julia hljs">analyse(imputed_data, raw_data, H0_file=&quot;copula_H0.xlsx&quot;; kwargs...)</code></pre><p>Performs the main Bayesian analysis pipeline on the provided proteomics data with multiple imputation.</p><p>This function integrates results from three different models:</p><ol><li>A Beta-Bernoulli model for detection probabilities.</li><li>A hierarchical Bayesian model for protein enrichment (log2 fold change).</li><li>A Bayesian linear regression model for dose-response correlation.</li></ol><p>The Bayes factors from these models are combined using a copula to calculate a final, joint Bayes factor and posterior probability for each protein. The analysis is parallelized across proteins.</p><p><strong>Arguments</strong></p><ul><li><code>imputed_data::Vector{InteractionData}</code>: The multiple imputed data set loaded as a vector of <code>InteractionData</code> objects. Used for HBM and regression models.</li><li><code>raw_data::InteractionData</code>: The non-imputed data. This dataset is used for the computation of the BF-detection (Beta-Bernoulli model).</li><li><code>H0_file::String</code>: Path to the H0 file containing precomputed Bayes factors for the null hypothesis. If the file does not exist, it will be computed.</li></ul><p><strong>Keywords</strong></p><p><strong>Basic Analysis Parameters</strong></p><ul><li><code>n_controls::Int=0</code>: Number of controls in the dataset.</li><li><code>n_samples::Int=0</code>: Number of samples in the dataset.</li><li><code>refID::Int=1</code>: The reference ID for the main analysis function, typically referring to a reference condition.</li><li><code>plotHBMdists::Bool=false</code>: If <code>true</code>, generates and saves plots of the hierarchical Bayesian model distributions.</li><li><code>plotlog2fc::Bool=false</code>: If <code>true</code>, generates and saves plots of the log2 fold changes.</li><li><code>plotregr::Bool=false</code>: If <code>true</code>, generates and saves plots of the regression model.</li><li><code>plotbayesrange::Bool=false</code>: If <code>true</code>, generates and saves plots of the Bayes factor ranges.</li><li><code>verbose::Bool=false</code>: If <code>true</code>, prints detailed progress and debugging information.</li></ul><p><strong>Caching Parameters</strong></p><ul><li><code>use_intermediate_cache::Bool=true</code>: If <code>true</code>, enables caching of intermediate results (Beta-Bernoulli and HBM+Regression).</li><li><code>betabernoulli_cache_file::String=&quot;&quot;</code>: Path to cache file for Beta-Bernoulli results. Empty string disables caching for this step.</li><li><code>hbm_regression_cache_file::String=&quot;&quot;</code>: Path to cache file for HBM and regression results. Empty string disables caching for this step.</li></ul><p><strong>Copula-EM Parameters</strong></p><ul><li><code>prior::Union{Symbol, NamedTuple}=:default</code>: Prior specification for the EM algorithm. Use <code>:default</code> for automatic prior or provide a NamedTuple with <code>(α=..., β=...)</code> for custom Beta prior parameters.</li><li><code>n_restarts::Int=20</code>: Number of random restarts for the EM algorithm to avoid local optima.</li><li><code>copula_criterion::Symbol=:BIC</code>: Model selection criterion for copula fitting. Options: <code>:BIC</code>, <code>:AIC</code>.</li><li><code>h1_refitting::Bool=true</code>: If <code>true</code>, refits the H1 (alternative hypothesis) distribution after EM convergence.</li><li><code>burn_in::Int=10</code>: Number of initial EM iterations to discard before convergence checking.</li></ul><p><strong>Diagnostics Parameters</strong></p><ul><li><code>run_em_diagnostics::Bool=true</code>: If <code>true</code> and <code>n_restarts &gt; 1</code>, runs diagnostic analysis of EM restart stability and convergence.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: A named tuple containing the analysis results with the following fields:<ul><li><code>copula_results::DataFrame</code>: DataFrame with combined Bayes factors, posterior probabilities, q-values, and other key metrics for each protein.</li><li><code>df_hierarchical::DataFrame</code>: DataFrame with detailed results from the hierarchical and regression models.</li><li><code>convergence_plt</code>: A plot diagnosing the convergence of the EM algorithm.</li><li><code>em</code>: The fitted Expectation-Maximization model object.</li><li><code>joint_H0</code>: The estimated joint distribution under the null hypothesis (H0).</li><li><code>joint_H1</code>: The estimated joint distribution under the alternative hypothesis (H1).</li><li><code>em_diagnostics</code>: Detailed diagnostics from EM restart analysis (if <code>run_em_diagnostics=true</code> and <code>n_restarts &gt; 1</code>).</li><li><code>em_diagnostics_summary</code>: Summary statistics of EM diagnostics (if <code>run_em_diagnostics=true</code> and <code>n_restarts &gt; 1</code>).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L490-L545">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.CONFIG"><a class="docstring-binding" href="#BayesInteractomics.CONFIG"><code>BayesInteractomics.CONFIG</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CONFIG</code></pre><p>A struct to hold all configuration parameters for the analysis pipeline.</p><p>This struct uses <code>Base.@kwdef</code> to allow initialization by keyword arguments.</p><p><strong>Required Fields</strong></p><ul><li><code>datafile::Vector{String}</code>: Paths to the input data files (e.g., Excel files).</li><li><code>control_cols::Vector{Dict{Int,Vector{Int}}}</code>: Control columns for each data file.</li><li><code>sample_cols::Vector{Dict{Int,Vector{Int}}}</code>: Sample columns for each data file.</li><li><code>poi::String</code>: Identifier for the protein of interest (bait protein), used for the meta-learner.</li></ul><p><strong>Output</strong></p><ul><li><code>output::OutputFiles = OutputFiles(&quot;.&quot;)</code>: Output file paths. Construct with <code>OutputFiles(basedir)</code> for auto-generated paths.</li></ul><p><strong>Analysis Parameters</strong></p><ul><li><code>normalise_protocols::Bool = true</code>: Normalize data across different experimental protocols.</li><li><code>n_controls::Int = 0</code>: Number of control experiments.</li><li><code>n_samples::Int = 0</code>: Number of sample experiments.</li><li><code>refID::Int = 1</code>: The ID of the reference (bait) protein or reference condition.</li><li><code>plotHBMdists::Bool = false</code>: Plot HBM posterior distributions per protein.</li><li><code>plotlog2fc::Bool = false</code>: Plot log2 fold-change distributions.</li><li><code>plotregr::Bool = false</code>: Plot regression model fits.</li><li><code>plotbayesrange::Bool = false</code>: Plot Bayes factor range plots.</li><li><code>verbose::Bool = false</code>: Enable verbose logging output.</li><li><code>vc_legend_pos::Symbol = :topleft</code>: Legend position in the volcano plot.</li><li><code>metalearner_path::String</code>: Path to the metalearner model file.</li></ul><p><strong>Copula-EM Parameters</strong></p><ul><li><code>em_prior::Union{Symbol, NamedTuple{(:α, :β), ...}} = :default</code>: Prior for EM algorithm (<code>:default</code> or named tuple).</li><li><code>em_n_restarts::Int = 20</code>: Number of random restarts for EM.</li><li><code>copula_criterion::Symbol = :BIC</code>: Copula model selection criterion (<code>:BIC</code> or <code>:AIC</code>).</li><li><code>h1_refitting::Bool = true</code>: Re-fit H1 copula after initial EM.</li><li><code>em_burn_in::Int = 10</code>: EM burn-in iterations.</li><li><code>run_em_diagnostics::Bool = true</code>: Generate EM convergence diagnostics.</li></ul><p><strong>Evidence Combination</strong></p><ul><li><code>combination_method::Symbol = :bma</code>: Evidence combination method (<code>:copula</code>, <code>:latent_class</code>, or <code>:bma</code> for Bayesian Model Averaging).</li></ul><p><strong>Latent Class Parameters (used when <code>combination_method = :latent_class</code>)</strong></p><ul><li><code>lc_n_iterations::Int = 100</code>: Maximum EM iterations for latent class model.</li><li><code>lc_alpha_prior::Vector{Float64} = [10.0, 1.0]</code>: Dirichlet prior on class proportions.</li><li><code>lc_convergence_tol::Float64 = 1e-6</code>: Convergence tolerance.</li><li><code>lc_winsorize::Bool = true</code>: Winsorize extreme Bayes factors.</li><li><code>lc_winsorize_quantiles::Tuple{Float64,Float64} = (0.01, 0.99)</code>: Winsorization quantiles.</li></ul><p><strong>Prior Sensitivity Analysis</strong></p><ul><li><code>run_sensitivity::Bool = true</code>: Run prior sensitivity analysis. Evaluates how robust posterior probabilities are to different prior specifications. Per-protein sensitivity metrics (std, min, max, range of posteriors; classification stability fractions) are merged into <code>final_results.xlsx</code> when diagnostics are also enabled.</li><li><code>sensitivity_config::SensitivityConfig = SensitivityConfig()</code>: Configuration for sensitivity analysis (prior grids for Beta-Bernoulli, EM, and latent class models).</li></ul><p><strong>Posterior Predictive Checks &amp; Model Diagnostics</strong></p><ul><li><code>run_diagnostics::Bool = false</code>: Run posterior predictive checks and model diagnostics. When enabled, computes per-protein diagnostic flags (observation counts, residual outliers, low-data warnings) for ALL proteins and merges them as columns into <code>final_results.xlsx</code>. Extended PPC statistics (p-values for skewness, kurtosis, IQR ratio) are available for the subset of proteins selected for PPC. Set <code>diagnostics_config.n_proteins_to_check</code> to control how many proteins undergo full PPC (default 50; set to total protein count for exhaustive checks).</li><li><code>diagnostics_config::DiagnosticsConfig = DiagnosticsConfig()</code>: Configuration for diagnostics (number of PPC draws, protein selection strategy, residual model, calibration bins, etc.).</li></ul><p><strong>Regression Model Comparison</strong></p><ul><li><code>run_model_comparison::Bool = true</code>: Run both Normal and robust regression models for all proteins and compare via WAIC. Refits regression posteriors for all proteins to compute pointwise WAIC.</li><li><code>regression_likelihood::Symbol = :robust_t</code>: Likelihood for regression models (<code>:normal</code> or <code>:robust_t</code>).</li><li><code>student_t_nu::Float64 = 5.0</code>: Degrees of freedom for Student-t distribution.</li><li><code>optimize_nu::Bool = run_diagnostics</code>: Optimize ν over [3, 50] via Brent&#39;s method minimizing WAIC. When <code>true</code>, automatically sets <code>student_t_nu</code> to the optimal value. Implies <code>run_model_comparison</code> (Normal WAIC is computed as baseline). Defaults to <code>true</code> when <code>run_diagnostics</code> is enabled.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L1030-L1100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.OutputFiles"><a class="docstring-binding" href="#BayesInteractomics.OutputFiles"><code>BayesInteractomics.OutputFiles</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">OutputFiles</code></pre><p>Struct holding all output file paths for the analysis pipeline.</p><p>Construct with <code>OutputFiles(basedir)</code> to auto-generate all paths under a single directory, or <code>OutputFiles(basedir; image_ext=&quot;.svg&quot;)</code> to change image format.</p><p>Individual paths can be overridden after construction since the struct is mutable.</p><p><strong>Fields</strong></p><ul><li><code>basedir::String</code>: Base directory for all output files.</li><li><code>H0_file::String</code>: Path to the null hypothesis Bayes factors file.</li><li><code>results_file::String</code>: Path for the final results Excel file.</li><li><code>volcano_file::String</code>: Path for the volcano plot image.</li><li><code>convergence_file::String</code>: Path for the EM convergence diagnostic plot.</li><li><code>evidence_file::String</code>: Path for the evidence plot.</li><li><code>dnn_file::String</code>: Path for the DNN/metalearner results Excel file.</li><li><code>rank_rank_file::String</code>: Path for the rank-rank plot image.</li><li><code>prior_file::String</code>: Path for the prior Excel file.</li><li><code>em_diagnostics_file::String</code>: Path for the EM diagnostics plot.</li><li><code>lc_convergence_file::String</code>: Path for the latent class convergence plot.</li><li><code>sensitivity_report_file::String</code>: Path for the sensitivity analysis report.</li><li><code>sensitivity_tornado_file::String</code>: Path for the sensitivity tornado plot.</li><li><code>sensitivity_heatmap_file::String</code>: Path for the sensitivity heatmap plot.</li><li><code>sensitivity_rankcorr_file::String</code>: Path for the sensitivity rank correlation plot.</li><li><code>pit_histogram_file::String</code>: Path for the PIT histogram plot.</li><li><code>nu_optimization_file::String</code>: Path for the Student-t ν optimization plot.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/analysis/pipeline.jl#L932-L960">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.AnalysisResult"><a class="docstring-binding" href="#BayesInteractomics.AnalysisResult"><code>BayesInteractomics.AnalysisResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AnalysisResult &lt;: AbstractAnalysisResult</code></pre><p>Complete results container from a BayesInteractomics analysis run with caching support.</p><p>This structure stores all outputs from <code>run_analysis()</code> along with hash-based validation to enable intelligent caching and avoid redundant computation.</p><p><strong>Fields</strong></p><ul><li><code>copula_results::DataFrame</code>: Final results with combined Bayes factors, posterior probabilities, and q-values</li><li><code>df_hierarchical::DataFrame</code>: Detailed hierarchical model results including individual protein statistics</li><li><code>em::Union{EMResult, Nothing}</code>: EM algorithm results from copula mixture fitting (copula mode only)</li><li><code>joint_H0::Union{SklarDist, Nothing}</code>: Fitted copula distribution under null hypothesis (copula mode only)</li><li><code>joint_H1::Union{SklarDist, Nothing}</code>: Fitted copula distribution under alternative hypothesis (copula mode only)</li><li><code>latent_class_result::Union{LatentClassResult, Nothing}</code>: VMP latent class results (latent class mode only)</li><li><code>bma_result::Union{BMAResult, Nothing}</code>: BMA results (BMA mode only)</li><li><code>combination_method::Symbol</code>: Evidence combination method used (<code>:copula</code>, <code>:latent_class</code>, or <code>:bma</code>)</li><li><code>em_diagnostics::Union{DataFrame, Nothing}</code>: EM algorithm restart diagnostics</li><li><code>em_diagnostics_summary::Union{NamedTuple, Nothing}</code>: Summary of EM restart diagnostics</li><li><code>config_hash::UInt64</code>: Hash of configuration parameters affecting computation (for cache validation)</li><li><code>data_hash::UInt64</code>: Hash of input data (for cache validation)</li><li><code>timestamp::DateTime</code>: Analysis completion time</li><li><code>package_version::String</code>: Package version used for analysis</li><li><code>bait_protein::Union{String, Nothing}</code>: Name or ID of the bait protein</li><li><code>bait_index::Union{Int, Nothing}</code>: Index of bait protein in the protein list</li><li><code>sensitivity::Union{SensitivityResult, Nothing}</code>: Prior sensitivity analysis results (if <code>run_sensitivity=true</code>)</li><li><code>diagnostics::Union{DiagnosticsResult, Nothing}</code>: Posterior predictive check and model diagnostics results (if <code>run_diagnostics=true</code>)</li></ul><p><strong>Iterator Interface</strong></p><p>Iterates over <code>(protein_name, row_data)</code> tuples from copula_results.</p><pre><code class="language-julia hljs">for (protein, row) in result
    println(&quot;$protein: BF = $(row.BF), q-value = $(row.q)&quot;)
end</code></pre><p><strong>Indexing</strong></p><ul><li><code>result[i]</code>: Get row i from copula_results (Integer indexing)</li><li><code>result[protein]</code>: Get row for specific protein (String indexing)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># After analysis
final_results, analysis_result = run_analysis(config)

# Access results
println(&quot;Analysis completed at: &quot;, analysis_result.timestamp)
println(&quot;Number of proteins: &quot;, length(analysis_result))

# Get specific protein
row = analysis_result[&quot;ProteinA&quot;]
println(&quot;BF: &quot;, row.BF, &quot;, Q-value: &quot;, row.q)

# Iterate over all proteins
for (protein, data) in analysis_result
    if data.posterior_prob &gt; 0.95
        println(&quot;$protein is likely an interactor&quot;)
    end
end

# Access sensitivity analysis (if available)
if !isnothing(analysis_result.sensitivity)
    sr = analysis_result.sensitivity
    println(&quot;Tested &quot;, length(sr.prior_settings), &quot; prior settings&quot;)
    println(&quot;Max posterior range: &quot;, maximum(sr.summary.range))
end

# Save for later
save_result(analysis_result, &quot;analysis_cache.jld2&quot;)</code></pre><p>See also: <a href="#BayesInteractomics.save_result"><code>save_result</code></a>, <a href="#BayesInteractomics.load_result"><code>load_result</code></a>, <a href="#BayesInteractomics.check_cache"><code>check_cache</code></a>, <a href="../diagnostics/#BayesInteractomics.sensitivity_analysis"><code>sensitivity_analysis</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/results.jl#L20-L93">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.save_result"><a class="docstring-binding" href="#BayesInteractomics.save_result"><code>BayesInteractomics.save_result</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">save_result(result::AnalysisResult, filepath::String)</code></pre><p>Save AnalysisResult to disk using JLD2 format with compression.</p><p><strong>Arguments</strong></p><ul><li><code>result::AnalysisResult</code>: Result structure to save</li><li><code>filepath::String</code>: Output file path (typically .jld2 extension)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">save_result(analysis_result, &quot;.bayesinteractomics_cache/analysis_cache.jld2&quot;)</code></pre><p>See also: <a href="#BayesInteractomics.load_result"><code>load_result</code></a>, <a href="../network_analysis/#AnalysisResult"><code>AnalysisResult</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/results.jl#L312-L327">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.load_result"><a class="docstring-binding" href="#BayesInteractomics.load_result"><code>BayesInteractomics.load_result</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">load_result(filepath::String)::Union{AnalysisResult, Nothing}</code></pre><p>Load AnalysisResult from disk, or return nothing if invalid/missing.</p><p>Returns <code>nothing</code> if:</p><ul><li>File doesn&#39;t exist</li><li>Cache version mismatch (indicates incompatible format)</li><li>Loading fails due to corruption or other errors</li></ul><p><strong>Arguments</strong></p><ul><li><code>filepath::String</code>: Path to cached result file</li></ul><p><strong>Returns</strong></p><ul><li><code>AnalysisResult</code>: Loaded result structure</li><li><code>nothing</code>: If file is missing, incompatible, or corrupted</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">cached = load_result(&quot;analysis_cache.jld2&quot;)
if !isnothing(cached)
    println(&quot;Loaded cached results from &quot;, cached.timestamp)
else
    println(&quot;No valid cache found, running analysis...&quot;)
end</code></pre><p>See also: <a href="#BayesInteractomics.save_result"><code>save_result</code></a>, <a href="#BayesInteractomics.check_cache"><code>check_cache</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/results.jl#L352-L380">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.check_cache"><a class="docstring-binding" href="#BayesInteractomics.check_cache"><code>BayesInteractomics.check_cache</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">check_cache(cache_file::String, config::CONFIG, data)</code></pre><p>Validate cached results against current configuration and data.</p><p>Checks if cached analysis results are still valid for the current config and data. Returns the cache status and loaded result (if valid).</p><p><strong>Arguments</strong></p><ul><li><code>cache_file::String</code>: Path to cache file</li><li><code>config::CONFIG</code>: Current configuration</li><li><code>data</code>: Current data (InteractionData or Tuple{Vector{InteractionData}, InteractionData})</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{CacheStatus, Union{AnalysisResult, Nothing}}</code>: Status and cached result (if hit)</li></ul><p><strong>Cache Hit</strong></p><p>When status is <code>CACHE_HIT</code>, the second element contains the valid cached result.</p><p><strong>Cache Miss</strong></p><p>When status is any MISS variant, the second element is <code>nothing</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">status, cached = check_cache(&quot;cache.jld2&quot;, config, data)

if status == CACHE_HIT
    @info &quot;Using cached results from $(cached.timestamp)&quot;
    # Use cached.copula_results, cached.joint_H0, etc.
elseif status == CACHE_MISS_CONFIG
    @info &quot;Config changed, recomputing...&quot;
elseif status == CACHE_MISS_DATA
    @info &quot;Data changed, recomputing...&quot;
else  # CACHE_MISS_NO_FILE
    @info &quot;No cache found, running analysis...&quot;
end</code></pre><p>See also: <a href="@ref"><code>CacheStatus</code></a>, <a href="@ref"><code>compute_config_hash</code></a>, <a href="@ref"><code>compute_data_hash</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/results.jl#L429-L468">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.evaluate_imputed_fc_posteriors"><a class="docstring-binding" href="#BayesInteractomics.evaluate_imputed_fc_posteriors"><code>BayesInteractomics.evaluate_imputed_fc_posteriors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">evaluate_imputed_fc_posteriors(results, protocol_positions; kwargs...)</code></pre><p>Pool Bayes factors and summary statistics from multiple imputation runs.</p><p>Combines the posterior inference results from several imputed datasets (stored as a <code>Vector{BayesResult}</code>) using Rubin&#39;s pooling rules.  For each parameter the function computes mixture distributions across imputations, derives pooled Bayes factors for both the HBM and regression models, and generates optional diagnostic plots.</p><p><strong>Arguments</strong></p><ul><li><code>results::Vector{BayesResult}</code>: One <code>BayesResult</code> per imputed dataset for the same protein.</li><li><code>protocol_positions</code>: Protocol position indices from <code>InteractionData</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>plotlog2fc::Bool=false</code>: Generate log₂FC distribution plots.</li><li><code>plotbayesrange::Bool=false</code>: Generate Bayes factor range plots.</li><li><code>threshold::Float64=0.0</code>: Log₂FC threshold for hypothesis testing.</li><li><code>csv_file::String=&quot;results.csv&quot;</code>: Path to write pooled CSV results.</li><li><code>writecsv::Bool=true</code>: Whether to write results to CSV.</li><li><code>α::Float64=0.95</code>: Credibility level for intervals.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> with fields:<ul><li><code>bfHBM</code>: Pooled Bayes factors from the hierarchical model</li><li><code>HBM_stats</code>: Pooled log₂FC summary statistics</li><li><code>bfRegression</code>: Pooled Bayes factors from the regression model</li><li><code>regression_stats</code>: Pooled regression summary statistics</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/data/imputation.jl#L110-L140">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data_curation/">« Data Curation</a><a class="docs-footer-nextpage" href="../model_fitting/">Model Fitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 28 February 2026 08:35">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
