<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diagnostics · BayesInteractomics.jl</title><meta name="title" content="Diagnostics · BayesInteractomics.jl"/><meta property="og:title" content="Diagnostics · BayesInteractomics.jl"/><meta property="twitter:title" content="Diagnostics · BayesInteractomics.jl"/><meta name="description" content="Documentation for BayesInteractomics.jl."/><meta property="og:description" content="Documentation for BayesInteractomics.jl."/><meta property="twitter:description" content="Documentation for BayesInteractomics.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/diagnostics/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/diagnostics/"/><link rel="canonical" href="https://ma-seefelder.github.io/BayesInteractomics.jl/diagnostics/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesInteractomics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../data_loading/">Data Loading</a></li><li><a class="tocitem" href="../data_curation/">Data Curation</a></li><li><a class="tocitem" href="../analysis/">Analysis Pipeline</a></li><li><a class="tocitem" href="../model_fitting/">Model Fitting</a></li><li><a class="tocitem" href="../model_evaluation/">Model Evaluation</a></li><li class="is-active"><a class="tocitem" href>Diagnostics</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Posterior-Predictive-Checks"><span>Posterior Predictive Checks</span></a></li><li><a class="tocitem" href="#Residual-Analysis"><span>Residual Analysis</span></a></li><li><a class="tocitem" href="#Calibration-Assessment"><span>Calibration Assessment</span></a></li><li><a class="tocitem" href="#Prior-Sensitivity-Analysis"><span>Prior Sensitivity Analysis</span></a></li><li><a class="tocitem" href="#Model-Comparison-(WAIC)"><span>Model Comparison (WAIC)</span></a></li><li><a class="tocitem" href="#Diagnostic-Flags"><span>Diagnostic Flags</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../differential_analysis/">Differential Analysis</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../reports/">Reports</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../mathematical_background/">Mathematical Background</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Diagnostics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Diagnostics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/main/docs/src/diagnostics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Diagnostics-and-Model-Validation"><a class="docs-heading-anchor" href="#Diagnostics-and-Model-Validation">Diagnostics and Model Validation</a><a id="Diagnostics-and-Model-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics-and-Model-Validation" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>BayesInteractomics provides a comprehensive diagnostics toolkit to validate the statistical models and assess result reliability. The diagnostics module includes:</p><ul><li><strong>Posterior Predictive Checks (PPC)</strong>: Simulate data from fitted models and compare to observations</li><li><strong>Residual Analysis</strong>: Detect model misspecification through standardized residuals</li><li><strong>Calibration Assessment</strong>: Verify that predicted probabilities match empirical discovery rates</li><li><strong>Prior Sensitivity Analysis</strong>: Evaluate how robust results are to prior choices</li></ul><p>All diagnostics can be run automatically via the <code>run_analysis</code> pipeline by setting <code>run_diagnostics=true</code> and <code>run_sensitivity=true</code> in the <a href="../analysis/#BayesInteractomics.CONFIG"><code>CONFIG</code></a> struct.</p><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><pre><code class="language-julia hljs">using BayesInteractomics

config = CONFIG(
    datafile = [&quot;data.xlsx&quot;],
    control_cols = [Dict(1 =&gt; [2,3,4])],
    sample_cols = [Dict(1 =&gt; [5,6,7])],
    poi = &quot;BAIT&quot;,
    refID = 1,
    n_controls = 3,
    n_samples = 3,
    # Enable diagnostics
    run_diagnostics = true,
    run_sensitivity = true,
    diagnostics_config = DiagnosticsConfig(
        n_proteins_to_check = 50,
        n_ppc_draws = 500
    )
)

final_df, result = run_analysis(config)</code></pre><p>When enabled, diagnostic flags and sensitivity metrics are automatically merged into the final results DataFrame.</p><h2 id="Posterior-Predictive-Checks"><a class="docs-heading-anchor" href="#Posterior-Predictive-Checks">Posterior Predictive Checks</a><a id="Posterior-Predictive-Checks-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-Predictive-Checks" title="Permalink"></a></h2><p>PPC validates model fit by re-running inference for a subset of proteins and comparing simulated data to the observations.</p><h3 id="How-It-Works"><a class="docs-heading-anchor" href="#How-It-Works">How It Works</a><a id="How-It-Works-1"></a><a class="docs-heading-anchor-permalink" href="#How-It-Works" title="Permalink"></a></h3><ol><li>Select proteins for checking (stratified by posterior probability)</li><li>Re-run Bayesian inference for each selected protein</li><li>Draw posterior predictive samples from the fitted model</li><li>Compare simulated data statistics to observed data</li></ol><h3 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h3><pre><code class="language-julia hljs">DiagnosticsConfig(
    n_proteins_to_check = 50,    # Number of proteins to check
    n_ppc_draws = 500,           # Posterior predictive draws per protein
    seed = 42,                   # RNG seed for reproducibility
    protein_selection = :stratified,  # :stratified, :random, or :top
    residual_model = :both,      # :hbm, :regression, or :both
    calibration_bins = 10        # Number of bins for calibration plot
)</code></pre><h3 id="PPC-Plots"><a class="docs-heading-anchor" href="#PPC-Plots">PPC Plots</a><a id="PPC-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#PPC-Plots" title="Permalink"></a></h3><pre><code class="language-julia hljs"># After running diagnostics through run_analysis, plots are saved automatically.
# Manual usage:
ppc_density_plot(ppc_result)         # Observed vs. predicted density
ppc_pvalue_histogram(diagnostics)    # Distribution of PPC p-values
bb_ppc_summary_plot(bb_ppcs)         # Beta-Bernoulli PPC summary</code></pre><p>A well-calibrated model produces a uniform distribution of PPC p-values.</p><h2 id="Residual-Analysis"><a class="docs-heading-anchor" href="#Residual-Analysis">Residual Analysis</a><a id="Residual-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-Analysis" title="Permalink"></a></h2><p>Standardized residuals reveal systematic deviations between model predictions and data.</p><h3 id="Available-Diagnostics"><a class="docs-heading-anchor" href="#Available-Diagnostics">Available Diagnostics</a><a id="Available-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Diagnostics" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Q-Q plot: residuals should follow a standard normal distribution
residual_qq_plot(residual_result)

# Scale-location plot: detect heteroscedasticity
scale_location_plot(residual_result)

# Distribution plot: inspect residual shape
residual_distribution_plot(residual_result)</code></pre><h3 id="Interpretation"><a class="docs-heading-anchor" href="#Interpretation">Interpretation</a><a id="Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Interpretation" title="Permalink"></a></h3><ul><li><strong>Q-Q plot</strong>: Points on the diagonal indicate well-behaved residuals</li><li><strong>Scale-location plot</strong>: A flat trend indicates constant variance (homoscedasticity)</li><li><strong>Heavy tails in Q-Q plot</strong>: Consider using robust regression (<code>regression_likelihood = :robust_t</code>)</li></ul><h2 id="Calibration-Assessment"><a class="docs-heading-anchor" href="#Calibration-Assessment">Calibration Assessment</a><a id="Calibration-Assessment-1"></a><a class="docs-heading-anchor-permalink" href="#Calibration-Assessment" title="Permalink"></a></h2><p>Calibration plots verify whether predicted posterior probabilities match empirical discovery rates.</p><pre><code class="language-julia hljs"># Standard calibration (all 3 BFs &gt; 1.0 as positive criterion)
calibration_plot(calibration_result)

# Compare strict vs. relaxed calibration criteria
calibration_comparison_plot(diagnostics_result)</code></pre><h3 id="Calibration-Criteria"><a class="docs-heading-anchor" href="#Calibration-Criteria">Calibration Criteria</a><a id="Calibration-Criteria-1"></a><a class="docs-heading-anchor-permalink" href="#Calibration-Criteria" title="Permalink"></a></h3><p>Three calibration strategies are computed automatically:</p><table><tr><th style="text-align: right">Strategy</th><th style="text-align: right">Positive criterion</th><th style="text-align: right">Use case</th></tr><tr><td style="text-align: right"><strong>Strict</strong></td><td style="text-align: right">All 3 BFs &gt; 1.0</td><td style="text-align: right">Conservative, low false positives</td></tr><tr><td style="text-align: right"><strong>Relaxed</strong></td><td style="text-align: right">≥2 of 3 BFs &gt; 1.0</td><td style="text-align: right">Moderate, handles noisy evidence</td></tr><tr><td style="text-align: right"><strong>Enrichment-only</strong></td><td style="text-align: right">BF_enrichment &gt; 3.0</td><td style="text-align: right">When detection/correlation are unreliable</td></tr></table><p>Perfect calibration means the points lie on the diagonal.</p><h2 id="Prior-Sensitivity-Analysis"><a class="docs-heading-anchor" href="#Prior-Sensitivity-Analysis">Prior Sensitivity Analysis</a><a id="Prior-Sensitivity-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Prior-Sensitivity-Analysis" title="Permalink"></a></h2><p>Evaluates how robust posterior probabilities are to different prior specifications.</p><h3 id="Configuration-2"><a class="docs-heading-anchor" href="#Configuration-2">Configuration</a><a class="docs-heading-anchor-permalink" href="#Configuration-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">SensitivityConfig(
    # Beta-Bernoulli prior grids
    bb_alpha_grid = [0.5, 1.0, 2.0, 5.0],
    bb_beta_grid = [0.5, 1.0, 2.0, 5.0],
    # EM prior grids
    em_prior_settings = [
        :default, :permissive, :stringent,
        (α = 10.0, β = 190.0),
        (α = 50.0, β = 100.0)
    ]
)</code></pre><h3 id="Sensitivity-Plots"><a class="docs-heading-anchor" href="#Sensitivity-Plots">Sensitivity Plots</a><a id="Sensitivity-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-Plots" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Tornado plot: which prior has the largest impact?
sensitivity_tornado_plot(sensitivity_result, n_top = 20)

# Heatmap: posterior probability across prior settings
sensitivity_heatmap(sensitivity_result, n_top = 20)

# Rank correlation: do rankings change with different priors?
sensitivity_rank_correlation(sensitivity_result)</code></pre><h3 id="Interpretation-2"><a class="docs-heading-anchor" href="#Interpretation-2">Interpretation</a><a class="docs-heading-anchor-permalink" href="#Interpretation-2" title="Permalink"></a></h3><ul><li><strong>Low sensitivity (range &lt; 0.1)</strong>: Results are robust; prior choice does not matter</li><li><strong>Moderate sensitivity (range 0.1–0.3)</strong>: Inspect individual proteins; borderline calls may change</li><li><strong>High sensitivity (range &gt; 0.3)</strong>: Consider collecting more data or using a more conservative threshold</li></ul><p>Per-protein sensitivity metrics (std, min, max, range) are merged into <code>final_results.xlsx</code> when both <code>run_diagnostics</code> and <code>run_sensitivity</code> are enabled.</p><h2 id="Model-Comparison-(WAIC)"><a class="docs-heading-anchor" href="#Model-Comparison-(WAIC)">Model Comparison (WAIC)</a><a id="Model-Comparison-(WAIC)-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Comparison-(WAIC)" title="Permalink"></a></h2><p>When <code>run_model_comparison = true</code> (default), BayesInteractomics fits both Normal and robust (Student-t) regression models and compares them via the Widely Applicable Information Criterion (WAIC).</p><pre><code class="language-julia hljs">config = CONFIG(
    # ...
    run_model_comparison = true,
    regression_likelihood = :robust_t,
    student_t_nu = 5.0,
    optimize_nu = true    # Optimize ν via Brent&#39;s method
)</code></pre><h3 id="ν-Optimization"><a class="docs-heading-anchor" href="#ν-Optimization">ν Optimization</a><a id="ν-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#ν-Optimization" title="Permalink"></a></h3><p>When <code>optimize_nu = true</code>, the degrees-of-freedom parameter ν is optimized over [3, 50] by minimizing WAIC. The result is shown in a diagnostic plot:</p><pre><code class="language-julia hljs">nu_optimization_plot(nu_result)</code></pre><h2 id="Diagnostic-Flags"><a class="docs-heading-anchor" href="#Diagnostic-Flags">Diagnostic Flags</a><a id="Diagnostic-Flags-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostic-Flags" title="Permalink"></a></h2><p>The diagnostics pipeline computes per-protein flags that are merged into the results:</p><table><tr><th style="text-align: right">Flag</th><th style="text-align: right">Meaning</th></tr><tr><td style="text-align: right"><code>low_data</code></td><td style="text-align: right">Fewer than 3 non-missing observations</td></tr><tr><td style="text-align: right"><code>residual_outlier</code></td><td style="text-align: right">Standardized residual &gt; 3 in magnitude</td></tr><tr><td style="text-align: right"><code>ppc_fail_hbm</code></td><td style="text-align: right">HBM PPC p-value &lt; 0.05</td></tr><tr><td style="text-align: right"><code>ppc_fail_regression</code></td><td style="text-align: right">Regression PPC p-value &lt; 0.05</td></tr><tr><td style="text-align: right"><code>high_sensitivity</code></td><td style="text-align: right">Posterior range across priors &gt; 0.3</td></tr></table><p>These flags help identify proteins whose results should be interpreted with caution.</p><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="BayesInteractomics.model_diagnostics"><a class="docstring-binding" href="#BayesInteractomics.model_diagnostics"><code>BayesInteractomics.model_diagnostics</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">model_diagnostics(ar, data::InteractionData; kwargs...) -&gt; DiagnosticsResult</code></pre><p>Run posterior predictive checks (PPC) and model diagnostics on analysis results.</p><p>Re-runs inference for a subset of proteins to generate posterior predictive samples, computes standardized residuals, and assesses calibration consistency.</p><p><strong>Arguments</strong></p><ul><li><code>ar</code>: Completed <code>AnalysisResult</code> from <code>run_analysis()</code></li><li><code>data::InteractionData</code>: Raw data used in the analysis</li></ul><p><strong>Keywords</strong></p><ul><li><code>config::DiagnosticsConfig</code>: Diagnostics configuration (default: <code>DiagnosticsConfig()</code>)</li><li><code>n_controls::Int</code>: Number of control replicates</li><li><code>n_samples::Int</code>: Number of sample replicates</li><li><code>refID::Int</code>: Bait protein index</li><li><code>verbose::Bool</code>: Print progress info</li></ul><p><strong>Returns</strong></p><ul><li><code>DiagnosticsResult</code> with PPC results, residuals, calibration, and summary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/predictive_checks.jl#L8-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.sensitivity_analysis"><a class="docstring-binding" href="#BayesInteractomics.sensitivity_analysis"><code>BayesInteractomics.sensitivity_analysis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sensitivity_analysis(ar, data::InteractionData; kwargs...) -&gt; SensitivityResult</code></pre><p>Run prior sensitivity analysis by sweeping Beta-Bernoulli detection priors and evidence combination priors (copula-EM or latent class), then summarizing how posterior probabilities change across the grid.</p><p>HBM/regression priors are excluded because they are data-driven (fitted via <code>τ0()</code>/<code>μ0()</code>).</p><p><strong>Arguments</strong></p><ul><li><code>ar</code>: Completed analysis result (<code>AnalysisResult</code>), provides baseline BFs and combination method</li><li><code>data::InteractionData</code>: Raw data (needed for BB recomputation)</li></ul><p><strong>Keywords</strong></p><ul><li><code>config::SensitivityConfig</code>: Grid specification (default: <code>SensitivityConfig()</code>)</li><li><code>n_controls::Int</code>: Number of control replicates</li><li><code>n_samples::Int</code>: Number of sample replicates</li><li><code>refID::Int</code>: Bait protein index</li><li><code>H0_file::String</code>: Path to H0 file for copula mode</li><li><code>combination_method::Symbol</code>: <code>:copula</code> or <code>:latent_class</code></li><li><code>lc_n_iterations::Int</code>: VMP iterations for latent class</li><li><code>lc_convergence_tol::Float64</code>: Convergence tolerance for latent class</li><li><code>verbose::Bool</code>: Print progress info</li></ul><p><strong>Returns</strong></p><ul><li><code>SensitivityResult</code> with posterior/BF/q matrices and summary statistics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/sensitivity.jl#L4-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.DiagnosticsConfig"><a class="docstring-binding" href="#BayesInteractomics.DiagnosticsConfig"><code>BayesInteractomics.DiagnosticsConfig</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DiagnosticsConfig</code></pre><p>Configuration for posterior predictive checks and model diagnostics.</p><p><strong>Fields</strong></p><ul><li><code>n_ppc_draws::Int</code>: Number of posterior predictive draws per protein (default: 1000)</li><li><code>n_proteins_to_check::Int</code>: Number of proteins to run PPC on (default: 50)</li><li><code>ppc_protein_selection::Symbol</code>: Strategy for selecting proteins — <code>:top_and_random</code> selects top N/2 by combined BF plus N/2 random (default: <code>:top_and_random</code>)</li><li><code>residual_model::Symbol</code>: Which model residuals to compute — <code>:both</code>, <code>:hbm</code>, or <code>:regression</code> (default: <code>:both</code>)</li><li><code>calibration_bins::Int</code>: Number of bins for calibration assessment (default: 10)</li><li><code>n_top_display::Int</code>: Number of top proteins to show in reports (default: 20)</li><li><code>seed::Int</code>: Random seed for reproducibility (default: 42)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L81-L95">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.SensitivityConfig"><a class="docstring-binding" href="#BayesInteractomics.SensitivityConfig"><code>BayesInteractomics.SensitivityConfig</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SensitivityConfig</code></pre><p>Configuration for prior sensitivity analysis sweeps.</p><p><strong>Fields</strong></p><ul><li><code>bb_priors</code>: Grid of (α, β) pairs for Beta-Bernoulli prior sweep</li><li><code>em_prior_grid</code>: Grid of (α, β) NamedTuples for copula-EM prior sweep</li><li><code>lc_alpha_prior_grid</code>: Grid of Dirichlet alpha vectors for latent class prior sweep</li><li><code>n_top_proteins</code>: Number of top proteins to highlight in reports</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L7-L17">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.SensitivityResult"><a class="docstring-binding" href="#BayesInteractomics.SensitivityResult"><code>BayesInteractomics.SensitivityResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SensitivityResult</code></pre><p>Complete results from a prior sensitivity analysis sweep.</p><p><strong>Fields</strong></p><ul><li><code>config</code>: The SensitivityConfig used for the sweep</li><li><code>prior_settings</code>: Vector of PriorSetting describing each column of the matrices</li><li><code>posterior_matrix</code>: Matrix of posterior probabilities (n<em>proteins × n</em>settings)</li><li><code>bf_matrix</code>: Matrix of combined Bayes factors (n<em>proteins × n</em>settings)</li><li><code>q_matrix</code>: Matrix of q-values (n<em>proteins × n</em>settings)</li><li><code>protein_names</code>: Vector of protein identifiers</li><li><code>baseline_index</code>: Column index of the baseline (default) prior setting</li><li><code>summary</code>: Per-protein summary statistics across all settings</li><li><code>classification_stability</code>: Per-protein classification stability across thresholds</li><li><code>timestamp</code>: When the analysis was run</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L47-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.CalibrationResult"><a class="docstring-binding" href="#BayesInteractomics.CalibrationResult"><code>BayesInteractomics.CalibrationResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CalibrationResult</code></pre><p>Calibration assessment comparing predicted posterior probabilities to observed agreement rates.</p><p>Note: Without a gold standard, &quot;observed truth&quot; is defined as internal consistency — a protein is empirically positive if all three individual Bayes factors (enrichment, correlation, detection) exceed 1.0. This is a self-consistency check, not true calibration.</p><p><strong>Fields</strong></p><ul><li><code>bin_midpoints::Vector{Float64}</code>: Midpoint of each probability bin</li><li><code>predicted_rate::Vector{Float64}</code>: Mean predicted posterior in each bin</li><li><code>observed_rate::Vector{Float64}</code>: Fraction of empirically positive proteins in each bin</li><li><code>bin_counts::Vector{Int}</code>: Number of proteins in each bin</li><li><code>ece::Float64</code>: Expected Calibration Error (weighted mean |predicted - observed|)</li><li><code>mce::Float64</code>: Maximum Calibration Error (max |predicted - observed|)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L181-L197">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.ResidualResult"><a class="docstring-binding" href="#BayesInteractomics.ResidualResult"><code>BayesInteractomics.ResidualResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ResidualResult</code></pre><p>Standardized residuals from HBM or regression model across all proteins.</p><p><strong>Fields</strong></p><ul><li><code>model::Symbol</code>: Which model produced these residuals (<code>:hbm</code> or <code>:regression</code>)</li><li><code>protein_names::Vector{String}</code>: Protein identifiers</li><li><code>residuals::Vector{Vector{Float64}}</code>: Per-protein residual vectors</li><li><code>mean_residuals::Vector{Float64}</code>: Mean residual per protein</li><li><code>pooled_residuals::Vector{Float64}</code>: All residuals concatenated</li><li><code>pooled_fitted::Vector{Float64}</code>: Fitted values parallel to <code>pooled_residuals</code> (for scale-location plots)</li><li><code>skewness::Float64</code>: Skewness of pooled residuals</li><li><code>kurtosis::Float64</code>: Excess kurtosis of pooled residuals</li><li><code>outlier_proteins::Vector{String}</code>: Proteins with |mean residual| &gt; 2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L153-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.ProteinPPC"><a class="docstring-binding" href="#BayesInteractomics.ProteinPPC"><code>BayesInteractomics.ProteinPPC</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ProteinPPC</code></pre><p>Posterior predictive check results for a single protein (HBM or regression model).</p><p><strong>Fields</strong></p><ul><li><code>protein_name::String</code>: Protein identifier</li><li><code>model::Symbol</code>: Which model produced this PPC (<code>:hbm</code> or <code>:regression</code>)</li><li><code>observed::Vector{Float64}</code>: Observed data values</li><li><code>simulated::Matrix{Float64}</code>: Simulated replicate data (n<em>obs × n</em>draws)</li><li><code>pvalue_mean::Float64</code>: Bayesian p-value for mean test statistic</li><li><code>pvalue_sd::Float64</code>: Bayesian p-value for standard deviation test statistic</li><li><code>pvalue_log2fc::Float64</code>: Bayesian p-value for log2FC test statistic (HBM only; NaN for regression)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L107-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.BetaBernoulliPPC"><a class="docstring-binding" href="#BayesInteractomics.BetaBernoulliPPC"><code>BayesInteractomics.BetaBernoulliPPC</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">BetaBernoulliPPC</code></pre><p>Posterior predictive check results for a single protein&#39;s Beta-Bernoulli detection model.</p><p><strong>Fields</strong></p><ul><li><code>protein_name::String</code>: Protein identifier</li><li><code>observed_k_sample::Int</code>: Observed detection count in samples</li><li><code>observed_k_control::Int</code>: Observed detection count in controls</li><li><code>simulated_k_sample::Vector{Int}</code>: Simulated sample detection counts (length = n_draws)</li><li><code>simulated_k_control::Vector{Int}</code>: Simulated control detection counts (length = n_draws)</li><li><code>pvalue_detection_diff::Float64</code>: Bayesian p-value for detection difference (sample - control)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/types.jl#L131-L143">source</a></section></details></article><h3 id="Diagnostic-Plots"><a class="docs-heading-anchor" href="#Diagnostic-Plots">Diagnostic Plots</a><a id="Diagnostic-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostic-Plots" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="BayesInteractomics.ppc_density_plot"><a class="docstring-binding" href="#BayesInteractomics.ppc_density_plot"><code>BayesInteractomics.ppc_density_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ppc_density_plot(ppc::ProteinPPC; file=&quot;&quot;)</code></pre><p>Overlay observed data density with simulated posterior predictive densities.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L4-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.ppc_pvalue_histogram"><a class="docstring-binding" href="#BayesInteractomics.ppc_pvalue_histogram"><code>BayesInteractomics.ppc_pvalue_histogram</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ppc_pvalue_histogram(dr::DiagnosticsResult; model=:all, file=&quot;&quot;)</code></pre><p>Plot histogram of Bayesian PPC p-values. Well-calibrated models produce a uniform distribution.</p><p><strong>Keywords</strong></p><ul><li><code>model::Symbol</code>: Filter by model (<code>:all</code>, <code>:hbm</code>, <code>:regression</code>, <code>:betabernoulli</code>)</li><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L41-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.residual_qq_plot"><a class="docstring-binding" href="#BayesInteractomics.residual_qq_plot"><code>BayesInteractomics.residual_qq_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">residual_qq_plot(res::ResidualResult; file=&quot;&quot;)</code></pre><p>Q-Q plot of standardized residuals against the standard Normal distribution.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L89-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.scale_location_plot"><a class="docstring-binding" href="#BayesInteractomics.scale_location_plot"><code>BayesInteractomics.scale_location_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scale_location_plot(res::ResidualResult; file=&quot;&quot;, n_bins=30)</code></pre><p>Scale-location plot: √|standardized residuals| vs fitted values.</p><p>A flat smoother line indicates homoscedasticity; an increasing trend reveals variance that grows with the predicted value.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li><li><code>n_bins::Int</code>: Number of equal-width bins for the binned smoother (default: 30)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L128-L139">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.residual_distribution_plot"><a class="docstring-binding" href="#BayesInteractomics.residual_distribution_plot"><code>BayesInteractomics.residual_distribution_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">residual_distribution_plot(res::ResidualResult; file=&quot;&quot;)</code></pre><p>Histogram of standardized residuals overlaid with a standard Normal density.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L193-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.calibration_plot"><a class="docstring-binding" href="#BayesInteractomics.calibration_plot"><code>BayesInteractomics.calibration_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calibration_plot(cal::CalibrationResult; file=&quot;&quot;)</code></pre><p>Predicted vs observed calibration plot with diagonal reference line.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L227-L234">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.calibration_comparison_plot"><a class="docstring-binding" href="#BayesInteractomics.calibration_comparison_plot"><code>BayesInteractomics.calibration_comparison_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calibration_comparison_plot(dr::DiagnosticsResult; file=&quot;&quot;)</code></pre><p>Overlay calibration curves from all available proxies (strict, relaxed, enrichment-only) on a single plot for direct comparison.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L272-L280">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.pit_histogram_plot"><a class="docstring-binding" href="#BayesInteractomics.pit_histogram_plot"><code>BayesInteractomics.pit_histogram_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pit_histogram_plot(pit_values::Vector{Float64}; n_bins=10, file=&quot;&quot;)</code></pre><p>Histogram of PIT (Probability Integral Transform) values with Uniform(0,1) reference line.</p><p>For a well-specified model, PIT values should be uniformly distributed. Deviations indicate:</p><ul><li><strong>U-shaped</strong>: underdispersion (model variance too small)</li><li><strong>Inverse-U (hump)</strong>: overdispersion (model variance too large)</li><li><strong>Skewed</strong>: location bias (systematic over/under-prediction)</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_bins::Int</code>: Number of histogram bins (default: 10)</li><li><code>title::String</code>: Plot title</li><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L323-L337">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.nu_optimization_plot"><a class="docstring-binding" href="#BayesInteractomics.nu_optimization_plot"><code>BayesInteractomics.nu_optimization_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nu_optimization_plot(res::NuOptimizationResult; file=&quot;&quot;)</code></pre><p>Plot the WAIC vs ν curve from Student-t ν optimization, showing the optimal ν and the Normal model baseline.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L363-L371">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.bb_ppc_summary_plot"><a class="docstring-binding" href="#BayesInteractomics.bb_ppc_summary_plot"><code>BayesInteractomics.bb_ppc_summary_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bb_ppc_summary_plot(bb_ppcs::Vector{BetaBernoulliPPC}; n_top=20, file=&quot;&quot;)</code></pre><p>Bar chart showing observed detection differences alongside simulated median and range for the top proteins by detection difference.</p><p><strong>Keywords</strong></p><ul><li><code>n_top::Int</code>: Number of proteins to display</li><li><code>file::String</code>: If non-empty, save plot to this path</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/diagnostic_plots.jl#L414-L423">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.sensitivity_tornado_plot"><a class="docstring-binding" href="#BayesInteractomics.sensitivity_tornado_plot"><code>BayesInteractomics.sensitivity_tornado_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sensitivity_tornado_plot(sr::SensitivityResult; n_top=0, file=&quot;&quot;)</code></pre><p>Horizontal bar chart showing the posterior probability range for the most sensitive proteins. Red diamonds mark the baseline posterior for each protein.</p><p><strong>Keywords</strong></p><ul><li><code>n_top::Int</code>: Number of top proteins to display (default: <code>sr.config.n_top_proteins</code>)</li><li><code>file::String</code>: If non-empty, save the plot to this path</li></ul><p><strong>Returns</strong></p><ul><li>StatsPlots plot object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/sensitivity_plots.jl#L4-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.sensitivity_heatmap"><a class="docstring-binding" href="#BayesInteractomics.sensitivity_heatmap"><code>BayesInteractomics.sensitivity_heatmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sensitivity_heatmap(sr::SensitivityResult; n_top=0, file=&quot;&quot;)</code></pre><p>Heatmap of posterior probabilities (proteins x prior settings) for the most sensitive proteins.</p><p><strong>Keywords</strong></p><ul><li><code>n_top::Int</code>: Number of top proteins to display (default: <code>sr.config.n_top_proteins</code>)</li><li><code>file::String</code>: If non-empty, save the plot to this path</li></ul><p><strong>Returns</strong></p><ul><li>StatsPlots plot object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/sensitivity_plots.jl#L62-L73">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.sensitivity_rank_correlation"><a class="docstring-binding" href="#BayesInteractomics.sensitivity_rank_correlation"><code>BayesInteractomics.sensitivity_rank_correlation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sensitivity_rank_correlation(sr::SensitivityResult; file=&quot;&quot;)</code></pre><p>Heatmap of mean absolute posterior difference between each pair of prior settings. Shows how much posterior probabilities diverge on average between any two settings. Values near 0 indicate agreement; larger values indicate prior sensitivity.</p><p><strong>Keywords</strong></p><ul><li><code>file::String</code>: If non-empty, save the plot to this path</li></ul><p><strong>Returns</strong></p><ul><li>StatsPlots plot object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/diagnostics/sensitivity_plots.jl#L114-L126">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_evaluation/">« Model Evaluation</a><a class="docs-footer-nextpage" href="../differential_analysis/">Differential Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 28 February 2026 08:35">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
