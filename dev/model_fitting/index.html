<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Fitting · BayesInteractomics.jl</title><meta name="title" content="Model Fitting · BayesInteractomics.jl"/><meta property="og:title" content="Model Fitting · BayesInteractomics.jl"/><meta property="twitter:title" content="Model Fitting · BayesInteractomics.jl"/><meta name="description" content="Documentation for BayesInteractomics.jl."/><meta property="og:description" content="Documentation for BayesInteractomics.jl."/><meta property="twitter:description" content="Documentation for BayesInteractomics.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/model_fitting/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/model_fitting/"/><link rel="canonical" href="https://ma-seefelder.github.io/BayesInteractomics.jl/model_fitting/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesInteractomics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../data_loading/">Data Loading</a></li><li><a class="tocitem" href="../data_curation/">Data Curation</a></li><li><a class="tocitem" href="../analysis/">Analysis Pipeline</a></li><li class="is-active"><a class="tocitem" href>Model Fitting</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Model-Components"><span>Model Components</span></a></li><li><a class="tocitem" href="#Model-Comparison-(WAIC)"><span>Model Comparison (WAIC)</span></a></li><li><a class="tocitem" href="#Evidence-Combination"><span>Evidence Combination</span></a></li><li><a class="tocitem" href="#Priors"><span>Priors</span></a></li><li><a class="tocitem" href="#Practical-Interpretation"><span>Practical Interpretation</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../model_evaluation/">Model Evaluation</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../differential_analysis/">Differential Analysis</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../reports/">Reports</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../mathematical_background/">Mathematical Background</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Model Fitting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Fitting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/main/docs/src/model_fitting.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-Fitting"><a class="docs-heading-anchor" href="#Model-Fitting">Model Fitting</a><a id="Model-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Fitting" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>BayesInteractomics implements a comprehensive Bayesian framework for analyzing protein-protein interactions through three complementary statistical models. Each model extracts a different type of evidence from the experimental data.</p><h2 id="Model-Components"><a class="docs-heading-anchor" href="#Model-Components">Model Components</a><a id="Model-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Components" title="Permalink"></a></h2><h3 id="Beta-Bernoulli-Detection-Model"><a class="docs-heading-anchor" href="#Beta-Bernoulli-Detection-Model">Beta-Bernoulli Detection Model</a><a id="Beta-Bernoulli-Detection-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Beta-Bernoulli-Detection-Model" title="Permalink"></a></h3><p>The Beta-Bernoulli model addresses a fundamental challenge in AP-MS experiments: distinguishing genuine interactions from background contamination. It models protein detection as a Bernoulli process with Beta-distributed probability.</p><p><strong>Key idea</strong>: If a protein is a true interactor, it should be detected more consistently in samples than in controls.</p><ul><li><strong>Prior</strong>: <code>Beta(α, β)</code> on detection probability</li><li><strong>Likelihood</strong>: Bernoulli observations (detected or not)</li><li><strong>Posterior</strong>: Updated Beta distribution</li><li><strong>Bayes factor</strong>: Compares detection rate in samples vs. controls</li></ul><pre><code class="language-julia hljs"># Low-level usage (called automatically by analyse)
bf, posterior_prob, prior_prob = betabernoulli(data, protein_idx, n_controls, n_samples)</code></pre><h3 id="Hierarchical-Bayesian-Model-(HBM)"><a class="docs-heading-anchor" href="#Hierarchical-Bayesian-Model-(HBM)">Hierarchical Bayesian Model (HBM)</a><a id="Hierarchical-Bayesian-Model-(HBM)-1"></a><a class="docs-heading-anchor-permalink" href="#Hierarchical-Bayesian-Model-(HBM)" title="Permalink"></a></h3><p>The HBM captures enrichment evidence through log₂ fold-change estimation:</p><ul><li><strong>Global level</strong>: Overall effect across all protocols</li><li><strong>Protocol level</strong>: Protocol-specific effects (e.g., AP-MS vs. BioID)</li><li><strong>Experiment level</strong>: Per-experiment fold-change estimates</li><li><strong>Inference</strong>: Variational Bayes via RxInfer</li></ul><p><strong>Key advantages</strong>:</p><ul><li>Borrows strength across experiments through hierarchical structure</li><li>Handles missing data naturally within the Bayesian framework</li><li>Produces reliable estimates even with few replicates</li><li>Generates Bayes factors for the enrichment hypothesis</li></ul><h3 id="Bayesian-Linear-Regression"><a class="docs-heading-anchor" href="#Bayesian-Linear-Regression">Bayesian Linear Regression</a><a id="Bayesian-Linear-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Linear-Regression" title="Permalink"></a></h3><p>The regression model assesses dose-response relationships: does prey abundance correlate with bait abundance?</p><p><strong>Standard model</strong>:</p><pre><code class="nohighlight hljs">y = β₀ + β₁·x + ε,    where ε ~ Normal(0, σ²)</code></pre><p><strong>Robust model</strong> (Student-t likelihood):</p><pre><code class="nohighlight hljs">y = β₀ + β₁·x + ε,    where ε ~ StudentT(ν, 0, σ²)</code></pre><p>The robust variant uses a scale-mixture representation of the Student-t distribution, making it resistant to outliers. The degrees-of-freedom parameter ν can be optimized via WAIC.</p><pre><code class="language-julia hljs"># Control regression model in CONFIG:
regression_likelihood = :robust_t   # or :normal
student_t_nu = 5.0                  # degrees of freedom
optimize_nu = true                  # optimize ν via WAIC</code></pre><h2 id="Model-Comparison-(WAIC)"><a class="docs-heading-anchor" href="#Model-Comparison-(WAIC)">Model Comparison (WAIC)</a><a id="Model-Comparison-(WAIC)-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Comparison-(WAIC)" title="Permalink"></a></h2><p>When <code>run_model_comparison = true</code>, both Normal and robust regression models are fitted for all proteins and compared using the Widely Applicable Information Criterion (WAIC):</p><pre><code class="nohighlight hljs">WAIC = -2 × (lppd - p_waic)</code></pre><p>where:</p><ul><li><code>lppd</code> = log pointwise predictive density (model fit)</li><li><code>p_waic</code> = effective number of parameters (model complexity)</li></ul><p>Lower WAIC indicates better predictive performance.</p><pre><code class="language-julia hljs"># Results include:
# - WAICResult for each model (waic, lppd, p_waic, se)
# - ModelComparisonResult (delta_waic, preferred model)
# - Per-protein WAIC when n_proteins is small enough</code></pre><h3 id="ν-Optimization"><a class="docs-heading-anchor" href="#ν-Optimization">ν Optimization</a><a id="ν-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#ν-Optimization" title="Permalink"></a></h3><p>When <code>optimize_nu = true</code>, BayesInteractomics searches for the optimal degrees-of-freedom:</p><ul><li>Search range: ν ∈ [3, 50]</li><li>Method: Brent&#39;s method minimizing WAIC</li><li>Result: Automatically sets <code>student_t_nu</code> to the optimal value</li><li>Diagnostic: <code>nu_optimization_plot</code> shows WAIC vs. ν</li></ul><h2 id="Evidence-Combination"><a class="docs-heading-anchor" href="#Evidence-Combination">Evidence Combination</a><a id="Evidence-Combination-1"></a><a class="docs-heading-anchor-permalink" href="#Evidence-Combination" title="Permalink"></a></h2><h3 id="Copula-Based-Combination-(default)"><a class="docs-heading-anchor" href="#Copula-Based-Combination-(default)">Copula-Based Combination (default)</a><a id="Copula-Based-Combination-(default)-1"></a><a class="docs-heading-anchor-permalink" href="#Copula-Based-Combination-(default)" title="Permalink"></a></h3><p>Individual Bayes factors are combined using copulas:</p><ol><li><strong>Convert</strong> BFs to posterior probabilities (assuming uniform prior)</li><li><strong>Fit null copula</strong> from permuted data (H₀ distribution)</li><li><strong>Fit mixture</strong> via EM: <code>π₀ · f₀(p) + π₁ · f₁(p)</code></li><li><strong>Compute</strong> joint Bayes factor from likelihood ratio</li></ol><p><strong>Supported copula families</strong>: | Family | Tail dependence | Symmetry | |–-|–-|–-| | Clayton | Lower tail | Asymmetric | | Frank | No tail | Symmetric | | Gumbel | Upper tail | Asymmetric | | Gaussian | No tail | Symmetric | | Joe | Upper tail | Asymmetric |</p><p>Best copula is selected automatically via BIC (or AIC).</p><p><strong>EM algorithm features</strong>:</p><ul><li>Multiple random restarts (<code>n_restarts = 20</code>)</li><li>SQUAREM acceleration for faster convergence</li><li>Weighted H₁ re-fitting in M-step (<code>h1_refitting = true</code>)</li><li>Informative Beta prior on π₁ (experiment-type specific)</li><li>Burn-in period before H₁ updates</li></ul><h3 id="Latent-Class-Combination-(alternative)"><a class="docs-heading-anchor" href="#Latent-Class-Combination-(alternative)">Latent Class Combination (alternative)</a><a id="Latent-Class-Combination-(alternative)-1"></a><a class="docs-heading-anchor-permalink" href="#Latent-Class-Combination-(alternative)" title="Permalink"></a></h3><pre><code class="language-julia hljs">combination_method = :latent_class</code></pre><p>Uses variational message passing (VMP) to fit a 2-class mixture model. Does not require a pre-computed H₀ file, making it useful when permutation-based null distributions are unavailable.</p><h2 id="Priors"><a class="docs-heading-anchor" href="#Priors">Priors</a><a id="Priors-1"></a><a class="docs-heading-anchor-permalink" href="#Priors" title="Permalink"></a></h2><h3 id="EM-Prior-on-π"><a class="docs-heading-anchor" href="#EM-Prior-on-π">EM Prior on π₁</a><a id="EM-Prior-on-π-1"></a><a class="docs-heading-anchor-permalink" href="#EM-Prior-on-π" title="Permalink"></a></h3><p>The mixing proportion π₁ (fraction of true interactors) uses an informative Beta prior:</p><table><tr><th style="text-align: right">Preset</th><th style="text-align: right">α</th><th style="text-align: right">β</th><th style="text-align: right">Expected π₁</th></tr><tr><td style="text-align: right"><code>:APMS</code></td><td style="text-align: right">20</td><td style="text-align: right">180</td><td style="text-align: right">~10%</td></tr><tr><td style="text-align: right"><code>:BioID</code></td><td style="text-align: right">30</td><td style="text-align: right">120</td><td style="text-align: right">~20%</td></tr><tr><td style="text-align: right"><code>:TurboID</code></td><td style="text-align: right">40</td><td style="text-align: right">110</td><td style="text-align: right">~25%</td></tr><tr><td style="text-align: right"><code>:default</code></td><td style="text-align: right">25</td><td style="text-align: right">175</td><td style="text-align: right">~12.5%</td></tr><tr><td style="text-align: right"><code>:permissive</code></td><td style="text-align: right">50</td><td style="text-align: right">100</td><td style="text-align: right">~33%</td></tr><tr><td style="text-align: right"><code>:stringent</code></td><td style="text-align: right">10</td><td style="text-align: right">190</td><td style="text-align: right">~5%</td></tr><tr><td style="text-align: right"><code>:empirical_bayes</code></td><td style="text-align: right">—</td><td style="text-align: right">—</td><td style="text-align: right">Data-driven</td></tr></table><p>Custom priors: <code>em_prior = (α = 15.0, β = 85.0)</code></p><h3 id="HBM-Priors"><a class="docs-heading-anchor" href="#HBM-Priors">HBM Priors</a><a id="HBM-Priors-1"></a><a class="docs-heading-anchor-permalink" href="#HBM-Priors" title="Permalink"></a></h3><p>HBM priors are estimated empirically from the data:</p><ul><li><code>τ₀()</code>: Fitted Gamma distribution on precision, estimated from control variability</li><li><code>μ₀()</code>: Returns <code>(median_of_means, max_variance)</code>, estimated from overall abundance</li></ul><h2 id="Practical-Interpretation"><a class="docs-heading-anchor" href="#Practical-Interpretation">Practical Interpretation</a><a id="Practical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-Interpretation" title="Permalink"></a></h2><h3 id="Bayes-Factor-Scale"><a class="docs-heading-anchor" href="#Bayes-Factor-Scale">Bayes Factor Scale</a><a id="Bayes-Factor-Scale-1"></a><a class="docs-heading-anchor-permalink" href="#Bayes-Factor-Scale" title="Permalink"></a></h3><table><tr><th style="text-align: right">Bayes Factor</th><th style="text-align: right">log₁₀(BF)</th><th style="text-align: right">Interpretation</th></tr><tr><td style="text-align: right">&gt; 100</td><td style="text-align: right">&gt; 2</td><td style="text-align: right">Decisive evidence</td></tr><tr><td style="text-align: right">30–100</td><td style="text-align: right">1.5–2</td><td style="text-align: right">Very strong</td></tr><tr><td style="text-align: right">10–30</td><td style="text-align: right">1–1.5</td><td style="text-align: right">Strong</td></tr><tr><td style="text-align: right">3–10</td><td style="text-align: right">0.5–1</td><td style="text-align: right">Moderate</td></tr><tr><td style="text-align: right">1–3</td><td style="text-align: right">0–0.5</td><td style="text-align: right">Weak</td></tr><tr><td style="text-align: right">&lt; 1</td><td style="text-align: right">&lt; 0</td><td style="text-align: right">Favors H₀</td></tr></table><p>Combined Bayes factors from multiple models are more reliable than any individual model, as they integrate complementary evidence sources.</p><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="BayesInteractomics.betabernoulli"><a class="docstring-binding" href="#BayesInteractomics.betabernoulli"><code>BayesInteractomics.betabernoulli</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">betabernoulli(data::InteractionData, idx::I, n_control::I, n_sample::I; create_plot::Bool=false) where {I &lt;: Int}</code></pre><p>Performs a Bayesian A/B test on protein detection rates using a Beta-Bernoulli model.</p><p>This function compares the detection rate of a specific protein (<code>idx</code>) between a sample group and a control group. It models the detection of a protein as a Bernoulli trial (detected or not detected). The underlying detection rate parameter, θ, is given a conjugate Beta prior (hardcoded as <code>Beta(3, 3)</code>), which represents a weak belief that the true rate is centered around 0.5.</p><p>The function calculates the analytical posterior distributions for the detection rates in both the sample group (<code>θ_sample</code>) and the control group (<code>θ_control</code>). It then uses numerical integration to compute the posterior probability <code>p = P(θ_sample &gt; θ_control | data)</code>.</p><p>Finally, it computes the Bayes Factor (BF₁₀) for the one-sided hypothesis:</p><ul><li>H₁: The detection rate in the sample is greater than in the control (θ<em>sample &gt; θ</em>control).</li><li>H₀: The detection rate in the sample is not greater than in the control (θ<em>sample ≤ θ</em>control).</li></ul><p><strong>Arguments</strong></p><ul><li><code>data::InteractionData</code>: The main data structure containing protein interaction data.</li><li><code>idx::Int</code>: The index of the specific protein to be analyzed from the <code>data</code> structure.</li><li><code>n_control::Int</code>: The number of data points in the sample group&#39;s data array.</li><li><code>n_sample::Int</code>: The number of data points in the control group&#39;s data array.</li><li><code>create_plot::Bool=false</code>: Whether to create visualization plot (expensive, defaults to false).</li></ul><p><strong>Returns</strong></p><p>A <code>Tuple{Float64, Float64, Union{Plots.Plot, Nothing}}</code> containing:</p><ol><li><code>BF::Float64</code>: The Bayes Factor in favor of H₁. A value &gt; 1 indicates evidence for the sample group having a higher detection rate.</li><li><code>p::Float64</code>: The posterior probability that the sample detection rate is greater than the control rate.</li><li><code>plt::Union{Plots.Plot, Nothing}</code>: A plot object from <code>StatsPlots.jl</code> visualizing the prior and the two posterior distributions, or <code>nothing</code> if <code>create_plot=false</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/betabernoulli.jl#L25-L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.BayesFactorHBM"><a class="docstring-binding" href="#BayesInteractomics.BayesFactorHBM"><code>BayesInteractomics.BayesFactorHBM</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">BayesFactorHBM(result::HBMResult; threshold::Float64 = 0.0)</code></pre><p>Compute the Bayes factor for each parameter&#39;s log₂ fold change between the posterior and prior from a hierarchical Bayesian model (HBM).</p><p><strong>Arguments</strong></p><ul><li><code>result</code>: An <code>HBMResult</code> object containing posterior and prior inference results.</li><li><code>threshold</code>: The log₂FC threshold for hypothesis testing (default = 0.0).</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of <code>(BF::Vector{Float64}, postProb::Vector{Float64}, priorProb::Vector{Float64})</code>, representing Bayes factors, posterior probability and prior probability.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/evaluation.jl#L1-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.BayesFactorRegression"><a class="docstring-binding" href="#BayesInteractomics.BayesFactorRegression"><code>BayesInteractomics.BayesFactorRegression</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">BayesFactorRegression(result::RegressionResultMultipleProtocols)

Computes the Bayes factor for a given posterior and prior inference results. 
    H1: ρ &gt; 0.0
    H0: ρ &lt;= 0.0

Args:
    - posterior&lt;:InferenceResult:   posterior inference result object of type InferenceResult 
    - prior&lt;:InferenceResult:       prior inference result object of type InferenceResult

Returns:
    - Bayes factor
    - posterior probability
    - prior probability</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/evaluation.jl#L37-L52">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.probability_of_direction"><a class="docstring-binding" href="#BayesInteractomics.probability_of_direction"><code>BayesInteractomics.probability_of_direction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">probability_of_direction(draws::Vector{Float64})
probability_of_direction(draws::Vector{Vector{Float64}})
probability_of_direction(posterior::Union{MixtureModel,Normal{Float64}})</code></pre><p>Compute the probability of direction (Maximum Probability of Effect - MPE) for a posterior distribution.</p><p><strong>Returns</strong></p><ul><li><code>pd::Float64</code>: Probability of direction (between 0.5 and 1.0).</li><li><code>direction::String</code>: &quot;+&quot; if effect is more likely positive, &quot;-&quot; if negative, or &quot;~&quot; if undecidable.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/evaluation.jl#L123-L133">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.pd_to_p_value"><a class="docstring-binding" href="#BayesInteractomics.pd_to_p_value"><code>BayesInteractomics.pd_to_p_value</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pd_to_p_value(pd, two_sided::Bool)
Converts the probability of direction (pd) to a p-value.

# Arguments
- `pd::Float64`: The probability of direction, assumed to be between 0.5 and 1.0.
- `two_sided::Bool`: Whether to return a two-sided p-value (default = `true`).

# Returns
- `p_value::Float64`: The corresponding frequentist-style p-value.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/evaluation.jl#L166-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.compute_waic"><a class="docstring-binding" href="#BayesInteractomics.compute_waic"><code>BayesInteractomics.compute_waic</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">compute_waic(data, regression_results, name_to_idx, refID; n_draws=1000, rng=GLOBAL_RNG) -&gt; WAICResult</code></pre><p>Compute WAIC from VMP posteriors for the regression model.</p><p>WAIC = -2 * (lppd - p_waic), where:</p><ul><li>lppd = Σᵢ log(1/S × Σₛ p(yᵢ | θˢ)) is the log pointwise predictive density</li><li>p<em>waic = Σᵢ var</em>s(log p(yᵢ | θˢ)) is the effective number of parameters</li></ul><p>For each observation yᵢ with reference xᵢ, draws S samples from q(α), q(β), q(τ) [and q(w) for robust model] and computes the pointwise log-likelihood.</p><p><strong>Arguments</strong></p><ul><li><code>data::InteractionData</code>: The interaction data</li><li><code>regression_results::Dict{String, &lt;:Union{RegressionResult, RobustRegressionResult}}</code>: Per-protein regression results</li><li><code>name_to_idx::Dict{String, Int}</code>: Map from protein name to data index</li><li><code>refID::Int</code>: Reference protein index</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_draws::Int=1000</code>: Number of posterior draws for WAIC estimation</li><li><code>rng::AbstractRNG=GLOBAL_RNG</code>: Random number generator</li></ul><p><strong>Returns</strong></p><ul><li><code>WAICResult</code>: WAIC statistics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/model_comparison.jl#L9-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.compare_regression_models"><a class="docstring-binding" href="#BayesInteractomics.compare_regression_models"><code>BayesInteractomics.compare_regression_models</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">compare_regression_models(data, normal_results, robust_results, name_to_idx, refID; n_draws=1000, rng=GLOBAL_RNG) -&gt; ModelComparisonResult</code></pre><p>Compare Normal vs. robust (Student-t) regression models via WAIC.</p><p><strong>Arguments</strong></p><ul><li><code>data::InteractionData</code>: The interaction data</li><li><code>normal_results::Dict{String, &lt;:RegressionResult}</code>: Results from Normal regression</li><li><code>robust_results::Dict{String, &lt;:RobustRegressionResult}</code>: Results from robust regression</li><li><code>name_to_idx::Dict{String, Int}</code>: Map from protein name to data index</li><li><code>refID::Int</code>: Reference protein index</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_draws::Int=1000</code>: Number of posterior draws for WAIC estimation</li><li><code>rng::AbstractRNG=GLOBAL_RNG</code>: Random number generator</li></ul><p><strong>Returns</strong></p><ul><li><code>ModelComparisonResult</code>: WAIC comparison with preferred model indication</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/model_comparison.jl#L151-L169">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.optimize_nu"><a class="docstring-binding" href="#BayesInteractomics.optimize_nu"><code>BayesInteractomics.optimize_nu</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">optimize_nu(data::InteractionData, config; lower=3.0, upper=50.0) -&gt; NuOptimizationResult</code></pre><p>Optimize the Student-t degrees-of-freedom parameter ν over [lower, upper] using Brent&#39;s method, minimizing WAIC for the robust regression model.</p><p>The Normal regression WAIC is computed once as a baseline for comparison.</p><p><strong>Arguments</strong></p><ul><li><code>data::InteractionData</code>: The interaction data</li><li><code>config</code>: Configuration object with fields <code>refID::Int</code> and <code>verbose::Bool</code> (e.g., <code>CONFIG</code>)</li></ul><p><strong>Keywords</strong></p><ul><li><code>lower::Float64=3.0</code>: Lower bound for ν search</li><li><code>upper::Float64=50.0</code>: Upper bound for ν search</li></ul><p><strong>Returns</strong></p><ul><li><code>NuOptimizationResult</code>: Optimization results including optimal ν, WAIC trace, and comparison</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/inference/model_comparison.jl#L317-L335">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.combined_BF"><a class="docstring-binding" href="#BayesInteractomics.combined_BF"><code>BayesInteractomics.combined_BF</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">combined_BF(bf::BayesFactorTriplet, refID::Int64; kwargs...)</code></pre><p>Combine individual Bayes factors using copula-based mixture model.</p><p><strong>Arguments</strong></p><ul><li><code>bf::BayesFactorTriplet</code>: Bayes factors from the three models</li><li><code>refID::Int64</code>: Index of the reference (bait) protein</li></ul><p><strong>Keywords</strong></p><ul><li><code>H0_file::String=&quot;copula_H0.xlsx&quot;</code>: Path to precomputed H0 Bayes factors</li><li><code>max_iter::Int=1000</code>: Maximum EM iterations</li><li><code>init_π0::Float64=0.80</code>: Initial π₀ (null proportion)</li><li><code>prior::Union{Symbol, NamedTuple}=:default</code>: Prior for π₁ (:APMS, :BioID, :TurboID, :default, :permissive, :stringent, :empirical_bayes, or custom (α=, β=))</li><li><code>n_restarts::Int=20</code>: Number of EM restarts (set to 1 to disable)</li><li><code>copula_criterion::Symbol=:BIC</code>: Copula selection criterion (:BIC, :AIC, :loglik)</li><li><code>h1_refitting::Bool=true</code>: Enable weighted H1 updates in M-step</li><li><code>burn_in::Int=10</code>: Number of iterations before starting H1 re-fitting</li><li><code>use_acceleration::Bool=true</code>: Enable SQUAREM acceleration for faster convergence</li><li><code>verbose::Bool=true</code>: Print progress information</li></ul><p><strong>Returns</strong></p><ul><li><code>CombinedBayesResult</code>: Combined Bayes factors and posterior probabilities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/combination/copula.jl#L816-L839">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.fit_copula"><a class="docstring-binding" href="#BayesInteractomics.fit_copula"><code>BayesInteractomics.fit_copula</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_copula(p::EvidenceTriplet; searchBestCopula=true, copula=FrankCopula, criterion=:BIC)</code></pre><p>Fit a copula to the posterior probability triplet.</p><p><strong>Arguments</strong></p><ul><li><code>p::EvidenceTriplet</code>: Evidence triplet (Bayes factors or posterior probabilities)</li></ul><p><strong>Keywords</strong></p><ul><li><code>searchBestCopula::Bool=true</code>: If true, select best copula family automatically</li><li><code>copula=FrankCopula</code>: Copula type to use if <code>searchBestCopula=false</code></li><li><code>criterion::Symbol=:BIC</code>: Selection criterion when searching (<code>:BIC</code>, <code>:AIC</code>, <code>:loglik</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Fitted copula object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/combination/copula.jl#L778-L793">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.compare_copulas"><a class="docstring-binding" href="#BayesInteractomics.compare_copulas"><code>BayesInteractomics.compare_copulas</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">compare_copulas(p::EvidenceTriplet; criterion::Symbol=:BIC)</code></pre><p>Fits multiple copulas to posterior probabilities and compares their fit using the specified criterion. Returns a sorted DataFrame.</p><p>If <code>p</code> is a <code>BayesFactorTriplet</code>, it is converted to posterior probabilities (assuming prior odds = 1).</p><p><strong>Arguments</strong></p><ul><li><code>p::EvidenceTriplet</code>: Vector of posterior probabilities or Bayes Factors</li></ul><p><strong>Keywords</strong></p><ul><li><code>criterion::Symbol=:BIC</code>: Selection criterion (<code>:BIC</code>, <code>:AIC</code>, or <code>:loglik</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Sorted comparison with columns <code>Family</code>, <code>LogLik</code>, <code>BIC</code>, <code>AIC</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/combination/copula.jl#L699-L716">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.posterior_probability_from_bayes_factor"><a class="docstring-binding" href="#BayesInteractomics.posterior_probability_from_bayes_factor"><code>BayesInteractomics.posterior_probability_from_bayes_factor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">posterior_probability_from_bayes_factor(bf::BayesFactorTriplet) -&gt; PosteriorProbabilityTriplet</code></pre><p>Converts a <code>BayesFactorTriplet</code> into a <code>PosteriorProbabilityTriplet</code>.</p><p>This function takes a triplet of Bayes factor vectors (for enrichment, correlation, and detection) and converts each vector into posterior probabilities, assuming prior odds of 1. It then returns these new vectors wrapped in a <code>PosteriorProbabilityTriplet</code> struct.</p><p><strong>Arguments</strong></p><ul><li><code>bf::BayesFactorTriplet{R}</code>: A struct containing vectors of Bayes factors for enrichment, correlation, and detection.</li></ul><p><strong>Returns</strong></p><ul><li><code>PosteriorProbabilityTriplet</code>: A struct containing the corresponding posterior probability vectors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/combination/copula.jl#L44-L58">source</a></section><section><div><pre><code class="language-julia hljs">posterior_probability_from_bayes_factor(bf)

Converts a Bayes Factor to a posterior probability assuming prior odds = 1. 

Edge cases:
- If bf = Inf, returns 1.0
- If bf = -Inf, returns 0.0
- If bf = NaN, returns 0.5 (uninformative)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/combination/copula.jl#L69-L78">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../analysis/">« Analysis Pipeline</a><a class="docs-footer-nextpage" href="../model_evaluation/">Model Evaluation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 28 February 2026 08:35">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
