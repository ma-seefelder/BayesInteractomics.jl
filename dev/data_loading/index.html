<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Loading · BayesInteractomics.jl</title><meta name="title" content="Data Loading · BayesInteractomics.jl"/><meta property="og:title" content="Data Loading · BayesInteractomics.jl"/><meta property="twitter:title" content="Data Loading · BayesInteractomics.jl"/><meta name="description" content="Documentation for BayesInteractomics.jl."/><meta property="og:description" content="Documentation for BayesInteractomics.jl."/><meta property="twitter:description" content="Documentation for BayesInteractomics.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/data_loading/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/data_loading/"/><link rel="canonical" href="https://ma-seefelder.github.io/BayesInteractomics.jl/data_loading/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesInteractomics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">User Guide</span><ul><li class="is-active"><a class="tocitem" href>Data Loading</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Data-Format-Requirements"><span>Data Format Requirements</span></a></li><li><a class="tocitem" href="#Loading-Data:-Column-Specification"><span>Loading Data: Column Specification</span></a></li><li><a class="tocitem" href="#The-load_data-Function"><span>The <code>load_data</code> Function</span></a></li><li><a class="tocitem" href="#Data-Structure-Reference"><span>Data Structure Reference</span></a></li><li><a class="tocitem" href="#Worked-Example"><span>Worked Example</span></a></li><li><a class="tocitem" href="#Protocol-Normalization"><span>Protocol Normalization</span></a></li><li><a class="tocitem" href="#Troubleshooting"><span>Troubleshooting</span></a></li><li><a class="tocitem" href="#Best-Practices"><span>Best Practices</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../data_curation/">Data Curation</a></li><li><a class="tocitem" href="../analysis/">Analysis Pipeline</a></li><li><a class="tocitem" href="../model_fitting/">Model Fitting</a></li><li><a class="tocitem" href="../model_evaluation/">Model Evaluation</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../differential_analysis/">Differential Analysis</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../reports/">Reports</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../mathematical_background/">Mathematical Background</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Data Loading</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data Loading</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/main/docs/src/data_loading.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Loading"><a class="docs-heading-anchor" href="#Data-Loading">Data Loading</a><a id="Data-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Loading" title="Permalink"></a></h1><p>This page explains how to load and structure your mass spectrometry data for analysis with BayesInteractomics.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>BayesInteractomics uses a <strong>hierarchical data structure</strong> that naturally reflects experimental design:</p><pre><code class="nohighlight hljs">InteractionData
├── Protocol 1 (e.g., GST-tagged AP-MS)
│   ├── Experiment 1 (biological replicate set 1)
│   │   ├── Control samples: [c1, c2, c3]
│   │   └── Bait samples: [s1, s2, s3]
│   ├── Experiment 2 (biological replicate set 2)
│   │   ├── Control samples: [c4, c5]
│   │   └── Bait samples: [s4, s5]
│   └── ...
└── Protocol 2 (e.g., Strep-tagged AP-MS)
    ├── Experiment 1
    │   ├── Control samples: [c1, c2, c3, c4]
    │   └── Bait samples: [s1, s2, s3]
    └── ...</code></pre><p>This structure enables:</p><ul><li><strong>Protocol-level modeling</strong>: Account for systematic differences between experimental methods</li><li><strong>Experiment-level variation</strong>: Handle batch effects within protocols</li><li><strong>Sample-level observations</strong>: Work with individual replicate measurements</li><li><strong>Missing data handling</strong>: Naturally accommodate proteins not detected in all replicates</li></ul><h2 id="Data-Format-Requirements"><a class="docs-heading-anchor" href="#Data-Format-Requirements">Data Format Requirements</a><a id="Data-Format-Requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Format-Requirements" title="Permalink"></a></h2><h3 id="File-Formats"><a class="docs-heading-anchor" href="#File-Formats">File Formats</a><a id="File-Formats-1"></a><a class="docs-heading-anchor-permalink" href="#File-Formats" title="Permalink"></a></h3><p>BayesInteractomics supports:</p><ul><li><strong>Excel files</strong> (.xlsx) - Recommended for most users</li><li><strong>CSV files</strong> (.csv) - Alternative for programmatic workflows</li></ul><h3 id="Data-Matrix-Structure"><a class="docs-heading-anchor" href="#Data-Matrix-Structure">Data Matrix Structure</a><a id="Data-Matrix-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Matrix-Structure" title="Permalink"></a></h3><p>Your data files should be organized as:</p><table><tr><th style="text-align: right">Column 1</th><th style="text-align: right">Column 2</th><th style="text-align: right">Column 3</th><th style="text-align: right">...</th><th style="text-align: right">Column N</th></tr><tr><td style="text-align: right"><strong>Protein ID</strong></td><td style="text-align: right"><strong>Sample/Control 1</strong></td><td style="text-align: right"><strong>Sample/Control 2</strong></td><td style="text-align: right">...</td><td style="text-align: right"><strong>Sample/Control N</strong></td></tr><tr><td style="text-align: right">PROTEIN_A</td><td style="text-align: right">25.3</td><td style="text-align: right">24.8</td><td style="text-align: right">...</td><td style="text-align: right">28.5</td></tr><tr><td style="text-align: right">PROTEIN_B</td><td style="text-align: right">22.1</td><td style="text-align: right">NA</td><td style="text-align: right">...</td><td style="text-align: right">22.0</td></tr><tr><td style="text-align: right">BAIT</td><td style="text-align: right">18.2</td><td style="text-align: right">18.5</td><td style="text-align: right">...</td><td style="text-align: right">32.1</td></tr></table><p><strong>Requirements</strong>:</p><ul><li><strong>First column</strong>: Protein identifiers (e.g., UniProt IDs, gene names, Ensembl IDs)</li><li><strong>Subsequent columns</strong>: Intensity values for each sample</li><li><strong>Values</strong>: Preferably log2-transformed intensities (though not strictly required)</li><li><strong>Missing data</strong>: Leave cells empty, use NA, or use Julia <code>missing</code></li><li><strong>Consistent protein order</strong>: All files should have proteins in the same order</li></ul><h3 id="Intensity-Normalization"><a class="docs-heading-anchor" href="#Intensity-Normalization">Intensity Normalization</a><a id="Intensity-Normalization-1"></a><a class="docs-heading-anchor-permalink" href="#Intensity-Normalization" title="Permalink"></a></h3><p>It&#39;s recommended to:</p><ol><li><strong>Log-transform</strong> intensities (log2 or ln) before loading</li><li><strong>Within-sample normalization</strong> (e.g., median normalization, TMM) if appropriate</li><li>Let BayesInteractomics handle <strong>protocol normalization</strong> via <code>normalise_protocols=true</code></li></ol><h2 id="Loading-Data:-Column-Specification"><a class="docs-heading-anchor" href="#Loading-Data:-Column-Specification">Loading Data: Column Specification</a><a id="Loading-Data:-Column-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Data:-Column-Specification" title="Permalink"></a></h2><p>The key to loading data correctly is specifying <strong>which columns contain which samples</strong>.</p><h3 id="Column-Mapping-Format"><a class="docs-heading-anchor" href="#Column-Mapping-Format">Column Mapping Format</a><a id="Column-Mapping-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Column-Mapping-Format" title="Permalink"></a></h3><p>Column mappings use nested dictionaries:</p><pre><code class="language-julia hljs">sample_cols = [
    # Protocol 1 column mapping
    Dict(
        1 =&gt; [5, 6, 7],      # Experiment 1: columns 5-7
        2 =&gt; [8, 9]          # Experiment 2: columns 8-9
    ),

    # Protocol 2 column mapping
    Dict(
        1 =&gt; [11, 12, 13, 14]  # Experiment 1: columns 11-14
    )
]</code></pre><p><strong>Structure</strong>:</p><ul><li><strong>Outer array</strong>: One element per protocol</li><li><strong>Inner Dict</strong>: Maps experiment IDs to column indices</li><li><strong>Column indices</strong>: 1-based (Julia convention), column 1 is protein IDs</li></ul><h3 id="Example:-Single-Protocol"><a class="docs-heading-anchor" href="#Example:-Single-Protocol">Example: Single Protocol</a><a id="Example:-Single-Protocol-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Single-Protocol" title="Permalink"></a></h3><p>For a simple experiment with one protocol and two experiments:</p><pre><code class="language-julia hljs">using BayesInteractomics

# Data file structure:
# Column 1: Protein IDs
# Columns 2-4: Control replicates from experiment 1
# Columns 5-7: Control replicates from experiment 2
# Columns 8-10: Sample replicates from experiment 1
# Columns 11-13: Sample replicates from experiment 2

control_cols = [
    Dict(
        1 =&gt; [2, 3, 4],      # Experiment 1 controls
        2 =&gt; [5, 6, 7]       # Experiment 2 controls
    )
]

sample_cols = [
    Dict(
        1 =&gt; [8, 9, 10],     # Experiment 1 samples
        2 =&gt; [11, 12, 13]    # Experiment 2 samples
    )
]

# Load data
data = load_data(
    [&quot;experiment_data.xlsx&quot;],
    sample_cols,
    control_cols,
    normalise_protocols = false  # Single protocol, no normalization needed
)</code></pre><h3 id="Example:-Multiple-Protocols"><a class="docs-heading-anchor" href="#Example:-Multiple-Protocols">Example: Multiple Protocols</a><a id="Example:-Multiple-Protocols-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Multiple-Protocols" title="Permalink"></a></h3><p>For combining data from different experimental methods:</p><pre><code class="language-julia hljs"># Protocol 1: AP-MS with GST tag (file: apms_gst.xlsx)
# Protocol 2: AP-MS with Strep tag (file: apms_strep.xlsx)

# Protocol 1 has 2 experiments, Protocol 2 has 1 experiment

control_cols = [
    # Protocol 1
    Dict(1 =&gt; [2, 3, 4], 2 =&gt; [5, 6]),

    # Protocol 2
    Dict(1 =&gt; [2, 3, 4, 5])
]

sample_cols = [
    # Protocol 1
    Dict(1 =&gt; [7, 8, 9], 2 =&gt; [10, 11, 12]),

    # Protocol 2
    Dict(1 =&gt; [6, 7, 8])
]

data = load_data(
    [&quot;apms_gst.xlsx&quot;, &quot;apms_strep.xlsx&quot;],
    sample_cols,
    control_cols,
    normalise_protocols = true  # IMPORTANT: Normalize across protocols
)</code></pre><h2 id="The-load_data-Function"><a class="docs-heading-anchor" href="#The-load_data-Function">The <code>load_data</code> Function</a><a id="The-load_data-Function-1"></a><a class="docs-heading-anchor-permalink" href="#The-load_data-Function" title="Permalink"></a></h2><h3 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h3><pre><code class="language-julia hljs">data = load_data(
    files::Vector{String},
    sample_cols::Vector{Dict{Int, Vector{Int}}},
    control_cols::Vector{Dict{Int, Vector{Int}}};
    normalise_protocols::Bool = false
)</code></pre><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><ul><li><strong><code>files</code></strong>: Vector of file paths (one per protocol)</li><li><strong><code>sample_cols</code></strong>: Column mappings for bait/treatment samples</li><li><strong><code>control_cols</code></strong>: Column mappings for negative control samples</li><li><strong><code>normalise_protocols</code></strong>: If <code>true</code>, normalizes data across protocols using z-score transformation</li></ul><h3 id="Return-Value"><a class="docs-heading-anchor" href="#Return-Value">Return Value</a><a id="Return-Value-1"></a><a class="docs-heading-anchor-permalink" href="#Return-Value" title="Permalink"></a></h3><p>Returns an <code>InteractionData</code> object containing:</p><ul><li>All protocols with their experiments</li><li>Sample and control data for each experiment</li><li>Protein identifiers</li><li>Metadata about data structure (positions, dimensions)</li></ul><h2 id="Data-Structure-Reference"><a class="docs-heading-anchor" href="#Data-Structure-Reference">Data Structure Reference</a><a id="Data-Structure-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structure-Reference" title="Permalink"></a></h2><h3 id="InteractionData-Type"><a class="docs-heading-anchor" href="#InteractionData-Type">InteractionData Type</a><a id="InteractionData-Type-1"></a><a class="docs-heading-anchor-permalink" href="#InteractionData-Type" title="Permalink"></a></h3><p>The <code>InteractionData</code> type is the central data container:</p><pre><code class="language-julia hljs"># Access protocols
for protocol in data
    println(&quot;Protocol: $(protocol.name)&quot;)

    # Access experiments within protocol
    for (exp_id, experiment_data) in protocol.experiments
        println(&quot;  Experiment $exp_id&quot;)
        println(&quot;    Size: $(size(experiment_data))&quot;)
    end
end

# Get number of proteins
n_proteins = getNoProteins(data)

# Get number of protocols
n_protocols = getNoProtocols(data)

# Extract data for specific protein
protein_data = getProteinData(data, protein_index)</code></pre><h3 id="Protocol-Type"><a class="docs-heading-anchor" href="#Protocol-Type">Protocol Type</a><a id="Protocol-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Protocol-Type" title="Permalink"></a></h3><p>Each protocol contains:</p><ul><li><strong><code>name</code></strong>: Protocol identifier</li><li><strong><code>proteinNames</code></strong>: Vector of protein IDs</li><li><strong><code>experiments</code></strong>: Dictionary mapping experiment IDs to data matrices</li></ul><h3 id="Protein-Type"><a class="docs-heading-anchor" href="#Protein-Type">Protein Type</a><a id="Protein-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Protein-Type" title="Permalink"></a></h3><p>Extracting protein-specific data:</p><pre><code class="language-julia hljs">protein = getProteinData(data, 42)  # Get protein at index 42

# Access samples and controls for each protocol
for (protocol_idx, (samples, controls)) in enumerate(protein)
    println(&quot;Protocol $protocol_idx:&quot;)
    println(&quot;  Samples: $samples&quot;)
    println(&quot;  Controls: $controls&quot;)
end</code></pre><h2 id="Worked-Example"><a class="docs-heading-anchor" href="#Worked-Example">Worked Example</a><a id="Worked-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Worked-Example" title="Permalink"></a></h2><p>Let&#39;s walk through loading a complete dataset:</p><h3 id="Step-1:-Prepare-Your-Files"><a class="docs-heading-anchor" href="#Step-1:-Prepare-Your-Files">Step 1: Prepare Your Files</a><a id="Step-1:-Prepare-Your-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Prepare-Your-Files" title="Permalink"></a></h3><p>Suppose you have:</p><ul><li><code>protocol1.xlsx</code>: AP-MS data with 2 experiments</li><li><code>protocol2.xlsx</code>: BioID data with 1 experiment</li></ul><p>Each file has the same proteins in the same order.</p><h3 id="Step-2:-Identify-Column-Indices"><a class="docs-heading-anchor" href="#Step-2:-Identify-Column-Indices">Step 2: Identify Column Indices</a><a id="Step-2:-Identify-Column-Indices-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Identify-Column-Indices" title="Permalink"></a></h3><p>Open your files and note which columns contain which data:</p><p><strong>protocol1.xlsx</strong>:</p><ul><li>Column 1: Protein IDs</li><li>Columns 2-4: Experiment 1 controls (3 replicates)</li><li>Columns 5-7: Experiment 1 samples (3 replicates)</li><li>Columns 8-10: Experiment 2 controls (3 replicates)</li><li>Columns 11-13: Experiment 2 samples (3 replicates)</li></ul><p><strong>protocol2.xlsx</strong>:</p><ul><li>Column 1: Protein IDs</li><li>Columns 2-5: Experiment 1 controls (4 replicates)</li><li>Columns 6-8: Experiment 1 samples (3 replicates)</li></ul><h3 id="Step-3:-Create-Column-Mappings"><a class="docs-heading-anchor" href="#Step-3:-Create-Column-Mappings">Step 3: Create Column Mappings</a><a id="Step-3:-Create-Column-Mappings-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Create-Column-Mappings" title="Permalink"></a></h3><pre><code class="language-julia hljs">control_cols = [
    # Protocol 1 (2 experiments)
    Dict(1 =&gt; [2, 3, 4], 2 =&gt; [8, 9, 10]),

    # Protocol 2 (1 experiment)
    Dict(1 =&gt; [2, 3, 4, 5])
]

sample_cols = [
    # Protocol 1 (2 experiments)
    Dict(1 =&gt; [5, 6, 7], 2 =&gt; [11, 12, 13]),

    # Protocol 2 (1 experiment)
    Dict(1 =&gt; [6, 7, 8])
]</code></pre><h3 id="Step-4:-Load-the-Data"><a class="docs-heading-anchor" href="#Step-4:-Load-the-Data">Step 4: Load the Data</a><a id="Step-4:-Load-the-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Load-the-Data" title="Permalink"></a></h3><pre><code class="language-julia hljs">using BayesInteractomics

data = load_data(
    [&quot;protocol1.xlsx&quot;, &quot;protocol2.xlsx&quot;],
    sample_cols,
    control_cols,
    normalise_protocols = true
)

@info &quot;Loaded data successfully&quot;
@info &quot;Proteins: $(getNoProteins(data))&quot;
@info &quot;Protocols: $(getNoProtocols(data))&quot;</code></pre><h3 id="Step-5:-Verify-the-Data"><a class="docs-heading-anchor" href="#Step-5:-Verify-the-Data">Step 5: Verify the Data</a><a id="Step-5:-Verify-the-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Verify-the-Data" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Check structure
println(&quot;Protocol 1:&quot;)
for (exp_id, exp_data) in data.protocols[1].experiments
    println(&quot;  Experiment $exp_id: $(size(exp_data))&quot;)
end

println(&quot;Protocol 2:&quot;)
for (exp_id, exp_data) in data.protocols[2].experiments
    println(&quot;  Experiment $exp_id: $(size(exp_data))&quot;)
end

# Check a specific protein
protein_42 = getProteinData(data, 42)
println(&quot;\nProtein at index 42:&quot;)
println(&quot;  Name: $(protein_42.name)&quot;)
println(&quot;  Protocol 1 samples: $(protein_42[1][1])&quot;)
println(&quot;  Protocol 1 controls: $(protein_42[1][2])&quot;)</code></pre><h2 id="Protocol-Normalization"><a class="docs-heading-anchor" href="#Protocol-Normalization">Protocol Normalization</a><a id="Protocol-Normalization-1"></a><a class="docs-heading-anchor-permalink" href="#Protocol-Normalization" title="Permalink"></a></h2><p>When <code>normalise_protocols = true</code>, BayesInteractomics applies z-score normalization to each protocol:</p><p class="math-container">\[x_{\text{norm}} = \frac{x - \mu}{\sigma}\]</p><p>where <span>$\mu$</span> and <span>$\sigma$</span> are computed from all samples within that protocol.</p><p><strong>When to use</strong>:</p><ul><li>✅ Multiple protocols with potentially different intensity scales</li><li>✅ Combining data from different labs or instruments</li><li>✅ Different experimental methods (e.g., AP-MS vs BioID)</li></ul><p><strong>When not to use</strong>:</p><ul><li>❌ Single protocol analysis</li><li>❌ Data already normalized to common scale</li><li>❌ Relative quantification methods (e.g., SILAC ratios)</li></ul><h2 id="Troubleshooting"><a class="docs-heading-anchor" href="#Troubleshooting">Troubleshooting</a><a id="Troubleshooting-1"></a><a class="docs-heading-anchor-permalink" href="#Troubleshooting" title="Permalink"></a></h2><h3 id="Common-Errors-and-Solutions"><a class="docs-heading-anchor" href="#Common-Errors-and-Solutions">Common Errors and Solutions</a><a id="Common-Errors-and-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Errors-and-Solutions" title="Permalink"></a></h3><p><strong>Error: &quot;Column index out of bounds&quot;</strong></p><p><strong>Cause</strong>: Column indices don&#39;t match file structure</p><p><strong>Solution</strong>:</p><ul><li>Check that column indices are 1-based</li><li>Verify file has the expected number of columns</li><li>Remember column 1 is protein IDs</li></ul><hr/><p><strong>Error: &quot;Protein names don&#39;t match across files&quot;</strong></p><p><strong>Cause</strong>: Different files have different protein sets or different order</p><p><strong>Solution</strong>:</p><ul><li>Ensure all files contain the same proteins</li><li>Proteins must be in the same row order across files</li><li>Use the same protein ID format in all files</li></ul><hr/><p><strong>Error: &quot;All values missing for protein X&quot;</strong></p><p><strong>Cause</strong>: Protein has no detected values in any sample</p><p><strong>Solution</strong>:</p><ul><li>This is a warning, not an error</li><li>Proteins with all missing values will have undefined Bayes factors</li><li>Consider pre-filtering proteins detected in at least some samples</li></ul><hr/><p><strong>Error: &quot;refID protein not found&quot;</strong></p><p><strong>Cause</strong>: The bait protein specified by <code>refID</code> doesn&#39;t exist at that row index</p><p><strong>Solution</strong>:</p><ul><li>Verify the row number of your bait protein (1-indexed)</li><li>Check that bait protein is present in all data files</li><li>Use <code>findfirst(==(&quot;BAIT_ID&quot;), protein_ids)</code> to find the correct index</li></ul><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><ol><li><strong>Consistent formatting</strong>: Use the same protein ID format across all files</li><li><strong>Quality control</strong>: Pre-filter proteins detected in very few samples</li><li><strong>Missing data</strong>: Don&#39;t artificially impute zeros - leave as missing</li><li><strong>Log transformation</strong>: Apply log2 transformation before loading if using raw intensities</li><li><strong>Documentation</strong>: Keep notes on column mappings for future reference</li><li><strong>Validation</strong>: Always inspect loaded data structure before running analysis</li></ol><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><p>Functions for loading and processing AP-MS and proximity labeling data.</p><article><details class="docstring" open="true"><summary id="BayesInteractomics.append_unique!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}}} where T"><a class="docstring-binding" href="#BayesInteractomics.append_unique!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}}} where T"><code>BayesInteractomics.append_unique!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">append_unique!(v1::Vector{T}, v2::Vector{T}) where T

Appends the elements of `v2` to `v1` if they are not already in `v1` and stores the result in `v1`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/utils.jl#L82-L86">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.cdf_log2FC-Tuple{Any}"><a class="docstring-binding" href="#BayesInteractomics.cdf_log2FC-Tuple{Any}"><code>BayesInteractomics.cdf_log2FC</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cdf_log2FC(log2FC}; threshold::Float64 = 0.0)

Compute the cumulative density probability of the log2FC for x &lt;= threshold. 

Args:
    - log2FC&lt;:Normal{Float64}: log2FC distribution (computed via log2FC)
    - threshold&lt;:Float64: threshold

Returns:
    - cdf_log2FC&lt;:Float64: cdf_log2FC</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/utils.jl#L68-L79">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.encode_png_file-Tuple{AbstractString}"><a class="docstring-binding" href="#BayesInteractomics.encode_png_file-Tuple{AbstractString}"><code>BayesInteractomics.encode_png_file</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">encode_png_file(filepath) -&gt; String</code></pre><p>Read a PNG/image file and return a <code>data:image/png;base64,...</code> URI string suitable for embedding in HTML.  Returns <code>&quot;&quot;</code> if the file does not exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L71-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.json_array-Tuple{AbstractVector{&lt;:AbstractString}}"><a class="docstring-binding" href="#BayesInteractomics.json_array-Tuple{AbstractVector{&lt;:AbstractString}}"><code>BayesInteractomics.json_array</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">json_array(items) -&gt; String</code></pre><p>Serialize a vector of already-serialized JSON strings to a JSON array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L51-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.json_bool-Tuple{Bool}"><a class="docstring-binding" href="#BayesInteractomics.json_bool-Tuple{Bool}"><code>BayesInteractomics.json_bool</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">json_bool(b) -&gt; String</code></pre><p>Serialize a Bool to a JSON literal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L44-L48">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.json_number-Tuple{Any}"><a class="docstring-binding" href="#BayesInteractomics.json_number-Tuple{Any}"><code>BayesInteractomics.json_number</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">json_number(x) -&gt; String</code></pre><p>Serialize a numeric value to a JSON literal. Returns <code>&quot;null&quot;</code> for <code>missing</code>, <code>NaN</code>, and <code>Inf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L4-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.json_object-Tuple{Vararg{Pair{&lt;:AbstractString, &lt;:AbstractString}}}"><a class="docstring-binding" href="#BayesInteractomics.json_object-Tuple{Vararg{Pair{&lt;:AbstractString, &lt;:AbstractString}}}"><code>BayesInteractomics.json_object</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">json_object(pairs...) -&gt; String</code></pre><p>Build a JSON object from alternating (key, already-serialized-value) pairs. Keys are auto-quoted; values must already be valid JSON strings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L60-L65">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.json_string-Tuple{AbstractString}"><a class="docstring-binding" href="#BayesInteractomics.json_string-Tuple{AbstractString}"><code>BayesInteractomics.json_string</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">json_string(s) -&gt; String</code></pre><p>Serialize a string to a JSON string literal with proper escaping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/reports/json_utils.jl#L21-L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.log2FC-Tuple{Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}, Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}}"><a class="docstring-binding" href="#BayesInteractomics.log2FC-Tuple{Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}, Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}}"><code>BayesInteractomics.log2FC</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">log2FC(sample::PosteriorNormalFamily, control::PosteriorNormalFamily)

Compute the log2FC between the sample and control and return a Normal distribution.

Args:
    - sample&lt;:Union{NormalWeightedMeanPrecision{Float64},NormalMeanPrecision{Float64}}: sample (result of inference)
    - control&lt;:Union{NormalWeightedMeanPrecision{Float64},NormalMeanPrecision{Float64}}: control (result of inference)

Returns:
    - log2FC&lt;:Normal{Float64}: log2FC</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/utils.jl#L48-L59">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.q-Tuple{Any}"><a class="docstring-binding" href="#BayesInteractomics.q-Tuple{Any}"><code>BayesInteractomics.q</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">q(values; isBF::Bool = true)</code></pre><p>Computes q-values from a vector of Bayes Factors or posterior probabilities, correctly and robustly handling missing values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/utils.jl#L105-L110">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.to_normal-Tuple{RxInfer.InferenceResult, Symbol}"><a class="docstring-binding" href="#BayesInteractomics.to_normal-Tuple{RxInfer.InferenceResult, Symbol}"><code>BayesInteractomics.to_normal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">to_normal(x::InferenceResult, key::Symbol)
Convert posterior to Normal distribution.

Args:
    - x&lt;:InferenceResult:     inference result object of type InferenceResult
    - key&lt;:Symbol:            key of the posterior distribution

Returns:
    - Vector{Normal{Float64}}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/core/utils.jl#L8-L18">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../data_curation/">Data Curation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 28 February 2026 08:35">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
