<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Differential Analysis · BayesInteractomics.jl</title><meta name="title" content="Differential Analysis · BayesInteractomics.jl"/><meta property="og:title" content="Differential Analysis · BayesInteractomics.jl"/><meta property="twitter:title" content="Differential Analysis · BayesInteractomics.jl"/><meta name="description" content="Documentation for BayesInteractomics.jl."/><meta property="og:description" content="Documentation for BayesInteractomics.jl."/><meta property="twitter:description" content="Documentation for BayesInteractomics.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/differential_analysis/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/BayesInteractomics.jl/differential_analysis/"/><link rel="canonical" href="https://ma-seefelder.github.io/BayesInteractomics.jl/differential_analysis/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesInteractomics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../data_loading/">Data Loading</a></li><li><a class="tocitem" href="../data_curation/">Data Curation</a></li><li><a class="tocitem" href="../analysis/">Analysis Pipeline</a></li><li><a class="tocitem" href="../model_fitting/">Model Fitting</a></li><li><a class="tocitem" href="../model_evaluation/">Model Evaluation</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li class="is-active"><a class="tocitem" href>Differential Analysis</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Statistical-Methodology"><span>Statistical Methodology</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Visualization"><span>Visualization</span></a></li><li><a class="tocitem" href="#Accessing-Results"><span>Accessing Results</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../reports/">Reports</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../mathematical_background/">Mathematical Background</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Differential Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Differential Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/main/docs/src/differential_analysis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-Interaction-Analysis"><a class="docs-heading-anchor" href="#Differential-Interaction-Analysis">Differential Interaction Analysis</a><a id="Differential-Interaction-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Interaction-Analysis" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>BayesInteractomics supports <strong>differential interaction analysis</strong> — comparing protein interaction profiles between two experimental conditions (e.g., wild-type vs. mutant, treated vs. untreated). This module identifies interactions that are gained, lost, or unchanged between conditions.</p><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><pre><code class="language-julia hljs">using BayesInteractomics

# Option 1: From two CONFIG objects (end-to-end pipeline)
config_wt = CONFIG(datafile=[&quot;wt.xlsx&quot;], ...)
config_mut = CONFIG(datafile=[&quot;mut.xlsx&quot;], ...)

diff = differential_analysis(config_wt, config_mut,
    condition_A = &quot;WT&quot;,
    condition_B = &quot;Mutant&quot;,
    config = DifferentialConfig(q_threshold = 0.05)
)

# Option 2: From pre-computed AnalysisResult objects
_, result_wt = run_analysis(config_wt)
_, result_mut = run_analysis(config_mut)

diff = differential_analysis(result_wt, result_mut,
    condition_A = &quot;WT&quot;,
    condition_B = &quot;Mutant&quot;
)</code></pre><h2 id="Statistical-Methodology"><a class="docs-heading-anchor" href="#Statistical-Methodology">Statistical Methodology</a><a id="Statistical-Methodology-1"></a><a class="docs-heading-anchor-permalink" href="#Statistical-Methodology" title="Permalink"></a></h2><p>For each protein present in both conditions, the module computes:</p><h3 id="1.-Differential-Bayes-Factor-(dBF)"><a class="docs-heading-anchor" href="#1.-Differential-Bayes-Factor-(dBF)">1. Differential Bayes Factor (dBF)</a><a id="1.-Differential-Bayes-Factor-(dBF)-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Differential-Bayes-Factor-(dBF)" title="Permalink"></a></h3><pre><code class="nohighlight hljs">dBF = BF_A / BF_B</code></pre><p>A <code>log₁₀(dBF) &gt; 0</code> means stronger evidence for interaction in condition A.</p><h3 id="2.-Per-Evidence-Differential"><a class="docs-heading-anchor" href="#2.-Per-Evidence-Differential">2. Per-Evidence Differential</a><a id="2.-Per-Evidence-Differential-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Per-Evidence-Differential" title="Permalink"></a></h3><p>The same ratio is computed separately for enrichment, correlation, and detection Bayes factors, allowing you to diagnose which evidence type drives the differential signal.</p><h3 id="3.-Effect-Size"><a class="docs-heading-anchor" href="#3.-Effect-Size">3. Effect Size</a><a id="3.-Effect-Size-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Effect-Size" title="Permalink"></a></h3><pre><code class="nohighlight hljs">Δlog₂FC = mean_log₂FC_A − mean_log₂FC_B</code></pre><h3 id="4.-Differential-Posterior-Probability"><a class="docs-heading-anchor" href="#4.-Differential-Posterior-Probability">4. Differential Posterior Probability</a><a id="4.-Differential-Posterior-Probability-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Differential-Posterior-Probability" title="Permalink"></a></h3><pre><code class="nohighlight hljs">P(differential | data) = |dBF| / (1 + |dBF|)</code></pre><p>This is a direction-agnostic measure of evidence for any difference.</p><h3 id="5.-Multiple-Testing-Correction"><a class="docs-heading-anchor" href="#5.-Multiple-Testing-Correction">5. Multiple Testing Correction</a><a id="5.-Multiple-Testing-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Multiple-Testing-Correction" title="Permalink"></a></h3><p>Bayesian FDR q-values are computed on the differential posterior probabilities.</p><h3 id="6.-Interaction-Classification"><a class="docs-heading-anchor" href="#6.-Interaction-Classification">6. Interaction Classification</a><a id="6.-Interaction-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#6.-Interaction-Classification" title="Permalink"></a></h3><p>Proteins are classified into categories based on the classification method:</p><table><tr><th style="text-align: right">Class</th><th style="text-align: right">Meaning</th></tr><tr><td style="text-align: right"><code>GAINED</code></td><td style="text-align: right">Interaction present in A but not in B (or stronger in A)</td></tr><tr><td style="text-align: right"><code>REDUCED</code></td><td style="text-align: right">Interaction present in B but not in A (or stronger in B)</td></tr><tr><td style="text-align: right"><code>UNCHANGED</code></td><td style="text-align: right">Similar interaction strength in both conditions</td></tr><tr><td style="text-align: right"><code>BOTH_NEGATIVE</code></td><td style="text-align: right">Neither condition shows strong interaction evidence</td></tr><tr><td style="text-align: right"><code>CONDITION_A_SPECIFIC</code></td><td style="text-align: right">Protein only detected in condition A</td></tr><tr><td style="text-align: right"><code>CONDITION_B_SPECIFIC</code></td><td style="text-align: right">Protein only detected in condition B</td></tr></table><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><pre><code class="language-julia hljs">DifferentialConfig(
    # Significance thresholds
    q_threshold = 0.05,                 # FDR threshold
    dbf_threshold = 1.0,                # |log10(dBF)| threshold
    delta_log2fc_threshold = 1.0,       # |Δlog2FC| threshold
    posterior_threshold = 0.8,          # Min posterior for &quot;interactor&quot;

    # Classification method
    classification_method = :posterior,  # :posterior, :dbf, or :combined

    # Output file paths
    results_file = &quot;differential_results.xlsx&quot;,
    volcano_file = &quot;differential_volcano.png&quot;,
    evidence_file = &quot;differential_evidence.png&quot;,
    scatter_file = &quot;differential_scatter.png&quot;,
    classification_file = &quot;differential_classification.png&quot;,
    ma_file = &quot;differential_ma.png&quot;,

    # HTML report
    generate_report_html = true
)</code></pre><h3 id="Classification-Methods"><a class="docs-heading-anchor" href="#Classification-Methods">Classification Methods</a><a id="Classification-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Classification-Methods" title="Permalink"></a></h3><ul><li><strong><code>:posterior</code></strong> (default): Uses per-condition posterior probabilities. A protein is an &quot;interactor&quot; if <code>posterior &gt; posterior_threshold</code>. GAINED = interactor in A but not B with Δlog₂FC ≥ 0.</li><li><strong><code>:dbf</code></strong>: Uses <code>|log₁₀(dBF)| &gt; dbf_threshold</code> directly.</li><li><strong><code>:combined</code></strong>: Both posterior and dBF criteria must be satisfied.</li></ul><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><p>Five diagnostic plots are generated automatically:</p><h3 id="Volcano-Plot"><a class="docs-heading-anchor" href="#Volcano-Plot">Volcano Plot</a><a id="Volcano-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Volcano-Plot" title="Permalink"></a></h3><pre><code class="language-julia hljs">plt = differential_volcano_plot(diff)

# Customization
plt = differential_volcano_plot(diff,
    x_axis = :delta_log2fc,     # or :log10_dbf (default)
    y_axis = :differential_q,   # or :differential_posterior
    x_clip = 4.0                # Fixed x-axis range
)</code></pre><h3 id="Evidence-Plot"><a class="docs-heading-anchor" href="#Evidence-Plot">Evidence Plot</a><a id="Evidence-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Evidence-Plot" title="Permalink"></a></h3><p>Four-panel plot showing per-evidence-type differential Bayes factors:</p><pre><code class="language-julia hljs">plt = differential_evidence_plot(diff)</code></pre><h3 id="Scatter-Plot"><a class="docs-heading-anchor" href="#Scatter-Plot">Scatter Plot</a><a id="Scatter-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Scatter-Plot" title="Permalink"></a></h3><p>Compare a metric between conditions:</p><pre><code class="language-julia hljs">plt = differential_scatter_plot(diff, metric = :posterior_prob)
# Also: :bf, :log2fc</code></pre><h3 id="Classification-Plot"><a class="docs-heading-anchor" href="#Classification-Plot">Classification Plot</a><a id="Classification-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Classification-Plot" title="Permalink"></a></h3><p>Bar chart summarizing the count of proteins in each class:</p><pre><code class="language-julia hljs">plt = differential_classification_plot(diff)</code></pre><h3 id="MA-Plot"><a class="docs-heading-anchor" href="#MA-Plot">MA Plot</a><a id="MA-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#MA-Plot" title="Permalink"></a></h3><p>Detect systematic biases where differential enrichment correlates with overall abundance:</p><pre><code class="language-julia hljs">plt = differential_ma_plot(diff)</code></pre><h2 id="Accessing-Results"><a class="docs-heading-anchor" href="#Accessing-Results">Accessing Results</a><a id="Accessing-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Results" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Filter by classification
gained = gained_interactions(diff)
lost = lost_interactions(diff)
unchanged = unchanged_interactions(diff)

# Significant differential interactions (any direction)
sig = significant_differential(diff, q_threshold = 0.01)

# Export to Excel
export_differential(diff, &quot;results.xlsx&quot;)

# Access full results DataFrame
diff.results   # All proteins with statistics
diff.config    # Configuration used
diff.n_gained  # Count summaries</code></pre><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_analysis"><a class="docstring-binding" href="#BayesInteractomics.differential_analysis"><code>BayesInteractomics.differential_analysis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_analysis(result_A, result_B; condition_A, condition_B, config)</code></pre><p>Compare interaction profiles between two experimental conditions.</p><p>Takes two <code>AnalysisResult</code> objects (one per condition) and computes differential Bayes factors, posterior probabilities, and interaction classifications for each protein present in either condition.</p><p><strong>Arguments</strong></p><ul><li><code>result_A::AbstractAnalysisResult</code>: Results from condition A (e.g., wild-type)</li><li><code>result_B::AbstractAnalysisResult</code>: Results from condition B (e.g., mutant)</li></ul><p><strong>Keywords</strong></p><ul><li><code>condition_A::String = &quot;Condition_A&quot;</code>: Human-readable label for condition A</li><li><code>condition_B::String = &quot;Condition_B&quot;</code>: Human-readable label for condition B</li><li><code>config::DifferentialConfig = DifferentialConfig()</code>: Analysis configuration</li></ul><p><strong>Returns</strong></p><ul><li><code>DifferentialResult</code>: Complete differential analysis results</li></ul><p><strong>Statistical Methodology</strong></p><p>For each protein present in both conditions (inner join on Protein ID):</p><ol><li><p><strong>Differential Bayes Factor (dBF)</strong>: <code>BF_A / BF_B</code> (log-space subtraction). Positive <code>log10(dBF)</code> means stronger evidence for interaction in condition A.</p></li><li><p><strong>Per-evidence differential</strong>: Same ratio for enrichment, correlation, and detection BFs separately — diagnoses which evidence drives the signal.</p></li><li><p><strong>Effect size</strong>: <code>delta_log2FC = mean_log2FC_A - mean_log2FC_B</code>.</p></li><li><p><strong>Differential posterior</strong>: <code>P(diff | data) = |dBF| / (1 + |dBF|)</code>. Direction-agnostic measure of evidence for any difference.</p></li><li><p><strong>Multiple testing</strong>: Bayesian FDR q-values on differential posteriors.</p></li><li><p><strong>Classification</strong>: <code>GAINED</code>, <code>REDUCED</code>, <code>UNCHANGED</code>, or <code>BOTH_NEGATIVE</code> based on config method.</p></li></ol><p>Proteins found in only one condition are appended as <code>CONDITION_A_SPECIFIC</code> or <code>CONDITION_B_SPECIFIC</code> with <code>NaN</code> fill for the missing condition.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">result_wt = run_analysis(config_wt)[2]
result_mut = run_analysis(config_mut)[2]

diff = differential_analysis(result_wt, result_mut,
    condition_A = &quot;WT&quot;,
    condition_B = &quot;Mutant&quot;,
    config = DifferentialConfig(q_threshold = 0.01))

println(diff)
gained = gained_interactions(diff)</code></pre><p>See also: <a href="#BayesInteractomics.DifferentialResult"><code>DifferentialResult</code></a>, <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L9-L67">source</a></section><section><div><pre><code class="language-julia hljs">differential_analysis(config_A, config_B; condition_A, condition_B, config, scatter_metric)</code></pre><p>End-to-end differential interaction analysis pipeline.</p><p>Runs <code>run_analysis</code> on both <code>CONFIG</code> objects, compares the resulting interaction profiles, generates diagnostic plots (volcano, evidence, scatter), and exports results to an Excel file.</p><p><strong>Arguments</strong></p><ul><li><code>config_A::CONFIG</code>: Analysis configuration for condition A</li><li><code>config_B::CONFIG</code>: Analysis configuration for condition B</li></ul><p><strong>Keywords</strong></p><ul><li><code>condition_A::String = &quot;Condition_A&quot;</code>: Human-readable label for condition A</li><li><code>condition_B::String = &quot;Condition_B&quot;</code>: Human-readable label for condition B</li><li><code>config::DifferentialConfig = DifferentialConfig()</code>: Differential analysis parameters and output paths (see <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a>)</li><li><code>scatter_metric::Symbol = :posterior_prob</code>: Metric for the scatter plot (<code>:posterior_prob</code>, <code>:bf</code>, or <code>:log2fc</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>DifferentialResult</code>: Complete differential analysis results</li></ul><p><strong>Side Effects</strong></p><ul><li>Saves volcano plot to <code>config.volcano_file</code></li><li>Saves evidence plot to <code>config.evidence_file</code></li><li>Saves scatter plot to <code>config.scatter_file</code></li><li>Saves results Excel to <code>config.results_file</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">config_wt = CONFIG(datafile=[&quot;wt.xlsx&quot;], ...)
config_mut = CONFIG(datafile=[&quot;mut.xlsx&quot;], ...)

diff = differential_analysis(config_wt, config_mut,
    condition_A = &quot;WT&quot;,
    condition_B = &quot;Mutant&quot;,
    config = DifferentialConfig(
        q_threshold = 0.01,
        volcano_file = &quot;results/volcano.svg&quot;,
        results_file = &quot;results/differential.xlsx&quot;
    ))</code></pre><p>See also: <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a>, <a href="#BayesInteractomics.DifferentialResult"><code>DifferentialResult</code></a>, <a href="../analysis/#BayesInteractomics.run_analysis"><code>run_analysis</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L126-L172">source</a></section><section><div><pre><code class="language-julia hljs">differential_analysis(config_A, config_B, imputed_data_A, raw_data_A, imputed_data_B, raw_data_B; ...)</code></pre><p>End-to-end differential interaction analysis pipeline with multiple imputation support.</p><p>Runs <code>run_analysis</code> with imputed datasets on both conditions, compares the resulting interaction profiles, generates diagnostic plots (volcano, evidence, scatter), and exports results to an Excel file.</p><p><strong>Arguments</strong></p><ul><li><code>config_A::CONFIG</code>: Analysis configuration for condition A</li><li><code>config_B::CONFIG</code>: Analysis configuration for condition B</li><li><code>imputed_data_A::Vector{InteractionData}</code>: Imputed datasets for condition A</li><li><code>raw_data_A::InteractionData</code>: Raw (non-imputed) data for condition A (used for Beta-Bernoulli)</li><li><code>imputed_data_B::Vector{InteractionData}</code>: Imputed datasets for condition B</li><li><code>raw_data_B::InteractionData</code>: Raw (non-imputed) data for condition B (used for Beta-Bernoulli)</li></ul><p><strong>Keywords</strong></p><ul><li><code>condition_A::String = &quot;Condition_A&quot;</code>: Human-readable label for condition A</li><li><code>condition_B::String = &quot;Condition_B&quot;</code>: Human-readable label for condition B</li><li><code>config::DifferentialConfig = DifferentialConfig()</code>: Differential analysis parameters and output paths (see <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a>)</li><li><code>scatter_metric::Symbol = :posterior_prob</code>: Metric for the scatter plot (<code>:posterior_prob</code>, <code>:bf</code>, or <code>:log2fc</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>DifferentialResult</code>: Complete differential analysis results</li></ul><p><strong>Side Effects</strong></p><ul><li>Saves individual analysis outputs as configured in <code>config_A</code> and <code>config_B</code></li><li>Saves volcano plot to <code>config.volcano_file</code></li><li>Saves evidence plot to <code>config.evidence_file</code></li><li>Saves scatter plot to <code>config.scatter_file</code></li><li>Saves results Excel to <code>config.results_file</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">config_wt  = CONFIG(datafile=[&quot;wt.xlsx&quot;], ...)
config_mut = CONFIG(datafile=[&quot;mut.xlsx&quot;], ...)

diff = differential_analysis(config_wt, config_mut,
    wt_imputed, wt_raw, mut_imputed, mut_raw,
    condition_A = &quot;WT&quot;,
    condition_B = &quot;Mutant&quot;,
    config = DifferentialConfig(
        q_threshold = 0.01,
        volcano_file = &quot;results/volcano.svg&quot;,
        results_file = &quot;results/differential.xlsx&quot;
    ))</code></pre><p>See also: <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a>, <a href="#BayesInteractomics.DifferentialResult"><code>DifferentialResult</code></a>, <a href="../analysis/#BayesInteractomics.run_analysis"><code>run_analysis</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L222-L274">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.DifferentialConfig"><a class="docstring-binding" href="#BayesInteractomics.DifferentialConfig"><code>BayesInteractomics.DifferentialConfig</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DifferentialConfig</code></pre><p>Configuration for differential interaction analysis.</p><p><strong>Statistical Thresholds</strong></p><ul><li><code>posterior_threshold::Float64</code>: Minimum posterior probability to consider a protein as a true interactor in a given condition (default: 0.8)</li><li><code>q_threshold::Float64</code>: Maximum q-value (BFDR) for significance in differential analysis (default: 0.05)</li><li><code>delta_log2fc_threshold::Float64</code>: Minimum absolute difference in mean_log2FC to classify as gained/lost when both conditions show interaction (default: 1.0)</li><li><code>dbf_threshold::Float64</code>: Minimum absolute log10 differential Bayes factor to classify as gained/lost (default: 1.0, i.e., 10-fold BF difference)</li><li><code>classification_method::Symbol</code>: Method for classifying interactions:<ul><li><code>:posterior</code> (default): use posterior probability thresholds</li><li><code>:dbf</code>: use differential Bayes factor thresholds</li><li><code>:combined</code>: require both posterior and dBF criteria</li></ul></li></ul><p><strong>Output Paths (used by the pipeline method <code>differential_analysis(config_a, config_b)</code>)</strong></p><ul><li><code>results_file::String</code>: Path for the differential results Excel file (default: <code>&quot;differential_results.xlsx&quot;</code>)</li><li><code>volcano_file::String</code>: Path for the volcano plot image (default: <code>&quot;differential_volcano.png&quot;</code>)</li><li><code>evidence_file::String</code>: Path for the evidence plot image (default: <code>&quot;differential_evidence.png&quot;</code>)</li><li><code>scatter_file::String</code>: Path for the scatter plot image (default: <code>&quot;differential_scatter.png&quot;</code>)</li><li><code>classification_file::String</code>: Path for the classification bar chart (default: <code>&quot;differential_classification.png&quot;</code>)</li><li><code>ma_file::String</code>: Path for the MA plot (default: <code>&quot;differential_ma.png&quot;</code>)</li><li><code>generate_report_html::Bool</code>: Automatically generate an interactive HTML report after analysis (default: <code>true</code>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Default configuration
config = DifferentialConfig()

# Stringent thresholds with custom output paths
config = DifferentialConfig(
    posterior_threshold = 0.95,
    q_threshold = 0.01,
    classification_method = :combined,
    results_file = &quot;results/diff.xlsx&quot;,
    volcano_file = &quot;results/volcano.svg&quot;
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/types.jl#L33-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.DifferentialResult"><a class="docstring-binding" href="#BayesInteractomics.DifferentialResult"><code>BayesInteractomics.DifferentialResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DifferentialResult</code></pre><p>Complete results from a differential interaction analysis comparing two conditions.</p><p><strong>Fields</strong></p><p><strong>Result DataFrame</strong></p><ul><li><code>results::DataFrame</code>: Per-protein differential statistics. Columns: <code>Protein</code>, <code>bf_A</code>, <code>bf_B</code>, <code>dbf</code>, <code>log10_dbf</code>, <code>posterior_A</code>, <code>posterior_B</code>, <code>delta_posterior</code>, <code>q_A</code>, <code>q_B</code>, <code>log2fc_A</code>, <code>log2fc_B</code>, <code>delta_log2fc</code>, <code>bf_enrichment_A</code>, <code>bf_enrichment_B</code>, <code>dbf_enrichment</code>, <code>bf_correlation_A</code>, <code>bf_correlation_B</code>, <code>dbf_correlation</code>, <code>bf_detected_A</code>, <code>bf_detected_B</code>, <code>dbf_detected</code>, <code>differential_posterior</code>, <code>differential_q</code>, <code>classification</code></li></ul><p><strong>Condition labels</strong></p><ul><li><code>condition_A::String</code>: Label for condition A</li><li><code>condition_B::String</code>: Label for condition B</li></ul><p><strong>Configuration</strong></p><ul><li><code>config::DifferentialConfig</code>: Configuration used for this analysis</li></ul><p><strong>Metadata</strong></p><ul><li><code>n_proteins_A::Int</code>: Number of proteins in condition A</li><li><code>n_proteins_B::Int</code>: Number of proteins in condition B</li><li><code>n_shared::Int</code>: Number of shared proteins (inner join)</li><li><code>n_condition_A_specific::Int</code>: Proteins only in condition A</li><li><code>n_condition_B_specific::Int</code>: Proteins only in condition B</li><li><code>timestamp::DateTime</code>: When analysis was performed</li></ul><p><strong>Summary counts</strong></p><ul><li><code>n_gained::Int</code>: Interactions gained (stronger in condition A)</li><li><code>n_reduced::Int</code>: Interactions reduced (stronger in condition B)</li><li><code>n_unchanged::Int</code>: Interactions unchanged between conditions</li><li><code>n_both_negative::Int</code>: Proteins not detected in either condition but with significant differential evidence</li></ul><p><strong>Iterator Interface</strong></p><p>Iterates over <code>(protein_name, row_data)</code> tuples.</p><p><strong>Indexing</strong></p><ul><li><code>diff[i]</code>: Get row i from results (Integer indexing)</li><li><code>diff[protein]</code>: Get row for specific protein (String indexing)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">diff = differential_analysis(result_wt, result_mut,
    condition_A = &quot;WT&quot;, condition_B = &quot;Mutant&quot;)

# Summary
println(diff)

# Iterate
for (protein, row) in diff
    if row.classification == GAINED
        println(&quot;$protein gained in WT&quot;)
    end
end

# Index
row = diff[&quot;MYC&quot;]
println(&quot;dBF: &quot;, row.dbf)</code></pre><p>See also: <a href="#BayesInteractomics.differential_analysis"><code>differential_analysis</code></a>, <a href="#BayesInteractomics.DifferentialConfig"><code>DifferentialConfig</code></a>, <a href="#BayesInteractomics.InteractionClass"><code>InteractionClass</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/types.jl#L137-L201">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.InteractionClass"><a class="docstring-binding" href="#BayesInteractomics.InteractionClass"><code>BayesInteractomics.InteractionClass</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">InteractionClass</code></pre><p>Enum classifying the differential interaction status of a protein.</p><p><strong>Values</strong></p><ul><li><code>GAINED</code>: Interaction significantly stronger in condition A than B (PP<em>A ≥ threshold, PP</em>B &lt; threshold, Δlog₂FC ≥ 0)</li><li><code>REDUCED</code>: Interaction significantly stronger in condition B than A (PP<em>B ≥ threshold, PP</em>A &lt; threshold, Δlog₂FC ≤ 0)</li><li><code>UNCHANGED</code>: Both conditions show interaction; no significant directional difference, or ambiguous evidence</li><li><code>BOTH_NEGATIVE</code>: Neither condition detects interaction (PP below threshold), but differential evidence is significant</li><li><code>CONDITION_A_SPECIFIC</code>: Protein detected only in condition A results</li><li><code>CONDITION_B_SPECIFIC</code>: Protein detected only in condition B results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/types.jl#L9-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.gained_interactions"><a class="docstring-binding" href="#BayesInteractomics.gained_interactions"><code>BayesInteractomics.gained_interactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">gained_interactions(diff::DifferentialResult) -&gt; DataFrame</code></pre><p>Return only gained interactions (stronger in condition A).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L658-L662">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.lost_interactions"><a class="docstring-binding" href="#BayesInteractomics.lost_interactions"><code>BayesInteractomics.lost_interactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lost_interactions(diff::DifferentialResult) -&gt; DataFrame</code></pre><p>Return only reduced interactions (stronger in condition B).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L667-L671">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.unchanged_interactions"><a class="docstring-binding" href="#BayesInteractomics.unchanged_interactions"><code>BayesInteractomics.unchanged_interactions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">unchanged_interactions(diff::DifferentialResult) -&gt; DataFrame</code></pre><p>Return only unchanged interactions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L676-L680">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.significant_differential"><a class="docstring-binding" href="#BayesInteractomics.significant_differential"><code>BayesInteractomics.significant_differential</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">significant_differential(diff::DifferentialResult; q_threshold=0.05) -&gt; DataFrame</code></pre><p>Return all proteins with significant differential interaction evidence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L685-L689">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.export_differential"><a class="docstring-binding" href="#BayesInteractomics.export_differential"><code>BayesInteractomics.export_differential</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">export_differential(diff::DifferentialResult, filepath::String)</code></pre><p>Export differential analysis results to an Excel file.</p><p>Creates two sheets:</p><ul><li><code>&quot;differential&quot;</code>: Full results DataFrame (classification as strings)</li><li><code>&quot;summary&quot;</code>: Summary statistics and configuration parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/analysis.jl#L695-L703">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_volcano_plot"><a class="docstring-binding" href="#BayesInteractomics.differential_volcano_plot"><code>BayesInteractomics.differential_volcano_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_volcano_plot(diff::DifferentialResult; kwargs...)</code></pre><p>Create a volcano plot for differential interaction analysis.</p><p><strong>Keywords</strong></p><ul><li><code>x_axis::Symbol = :log10_dbf</code>: X-axis metric (<code>:log10_dbf</code> or <code>:delta_log2fc</code>)</li><li><code>y_axis::Symbol = :differential_q</code>: Y-axis metric (<code>:differential_q</code> → -log10(q), or <code>:differential_posterior</code>)</li><li><code>legend_pos::Symbol = :topleft</code>: Legend position</li><li><code>x_clip::Union{Float64,Nothing} = nothing</code>: X-axis half-width. When <code>nothing</code> (default), limits are set to the 0.5th–99.5th percentile of the data for a readable range. When a <code>Float64</code>, limits are <code>(-x_clip, x_clip)</code>. Points outside the limits are shown with triangular markers at the boundary so they remain visible.</li></ul><p><strong>Returns</strong></p><p>A StatsPlots plot object. Points colored by classification: green = GAINED, red = REDUCED, grey = UNCHANGED.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">diff = differential_analysis(result_wt, result_mut)
plt = differential_volcano_plot(diff)
StatsPlots.savefig(plt, &quot;differential_volcano.png&quot;)

# Use delta log2FC on x-axis
plt2 = differential_volcano_plot(diff, x_axis = :delta_log2fc)

# Fixed ±4 range
plt3 = differential_volcano_plot(diff, x_clip = 4.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/visualization.jl#L4-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_evidence_plot"><a class="docstring-binding" href="#BayesInteractomics.differential_evidence_plot"><code>BayesInteractomics.differential_evidence_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_evidence_plot(diff::DifferentialResult)</code></pre><p>Create a 4-panel plot showing per-evidence-type differential Bayes factors.</p><p>Panels:</p><ol><li>log10(dBF<em>enrichment) vs log10(dBF</em>correlation)</li><li>log10(dBF<em>enrichment) vs log10(dBF</em>detected)</li><li>log10(dBF<em>correlation) vs log10(dBF</em>detected)</li><li>Density of log10(dBF_combined)</li></ol><p>All scatter panels colored by classification (green/red/grey).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/visualization.jl#L193-L205">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_scatter_plot"><a class="docstring-binding" href="#BayesInteractomics.differential_scatter_plot"><code>BayesInteractomics.differential_scatter_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_scatter_plot(diff::DifferentialResult; metric=:posterior_prob)</code></pre><p>Scatter plot comparing a metric between conditions A and B.</p><p><strong>Keywords</strong></p><ul><li><code>metric::Symbol</code>: Which metric to compare:<ul><li><code>:posterior_prob</code> (default): Posterior probabilities</li><li><code>:bf</code>: Combined Bayes factors (log10 scale)</li><li><code>:log2fc</code>: Mean log2 fold change</li></ul></li></ul><p>Points colored by classification with identity line.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/visualization.jl#L260-L272">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_classification_plot"><a class="docstring-binding" href="#BayesInteractomics.differential_classification_plot"><code>BayesInteractomics.differential_classification_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_classification_plot(diff::DifferentialResult)</code></pre><p>Horizontal bar chart showing the count of proteins in each interaction class.</p><p>Bars are grouped as: GAINED, REDUCED, UNCHANGED, BOTH_NEGATIVE, condition-A-specific, condition-B-specific. Provides a quick sanity-check of the differential analysis at a glance.</p><p><strong>Returns</strong></p><p>A StatsPlots plot object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/visualization.jl#L329-L339">source</a></section></details></article><article><details class="docstring" open="true"><summary id="BayesInteractomics.differential_ma_plot"><a class="docstring-binding" href="#BayesInteractomics.differential_ma_plot"><code>BayesInteractomics.differential_ma_plot</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">differential_ma_plot(diff::DifferentialResult)</code></pre><p>MA-style plot for differential proteomics.</p><ul><li><strong>x-axis</strong>: ½ (log2FC<em>A + log2FC</em>B) — mean log2 fold change (proxy for abundance)</li><li><strong>y-axis</strong>: Δlog2FC = log2FC<em>A − log2FC</em>B — differential effect size</li><li>Horizontal reference line at y = 0</li><li>Points colored by classification (green = GAINED, red = REDUCED, grey = UNCHANGED)</li></ul><p>Useful for detecting systematic biases where differential enrichment correlates with overall enrichment level.</p><p><strong>Returns</strong></p><p>A StatsPlots plot object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/BayesInteractomics.jl/blob/da9940757d6ee60c6e14a6e4b3831d96ccec69c9/src/differential/visualization.jl#L375-L390">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../diagnostics/">« Diagnostics</a><a class="docs-footer-nextpage" href="../visualization/">Visualization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 28 February 2026 08:35">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
